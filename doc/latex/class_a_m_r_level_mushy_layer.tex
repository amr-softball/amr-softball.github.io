\hypertarget{class_a_m_r_level_mushy_layer}{}\section{A\+M\+R\+Level\+Mushy\+Layer Class Reference}
\label{class_a_m_r_level_mushy_layer}\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}


\textbf{ A\+M\+R\+Level} for mushy layer calculations.  




{\ttfamily \#include $<$A\+M\+R\+Level\+Mushy\+Layer.\+H$>$}

Inheritance diagram for A\+M\+R\+Level\+Mushy\+Layer\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_a_m_r_level_mushy_layer}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_adfca912f4bbd65b9d39f205a57bc651d}\label{class_a_m_r_level_mushy_layer_adfca912f4bbd65b9d39f205a57bc651d}} 
\hyperlink{class_a_m_r_level_mushy_layer_adfca912f4bbd65b9d39f205a57bc651d}{A\+M\+R\+Level\+Mushy\+Layer} ()
\begin{DoxyCompactList}\small\item\em Default constructor. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aff24e0ecc862006090258067f52e9d4c}\label{class_a_m_r_level_mushy_layer_aff24e0ecc862006090258067f52e9d4c}} 
\hyperlink{class_a_m_r_level_mushy_layer_aff24e0ecc862006090258067f52e9d4c}{A\+M\+R\+Level\+Mushy\+Layer} (\hyperlink{struct_mushy_layer_options}{Mushy\+Layer\+Options} a\+\_\+opt, \hyperlink{class_mushy_layer_params}{Mushy\+Layer\+Params} a\+\_\+params)
\begin{DoxyCompactList}\small\item\em Full constructor. Arguments are same as in \hyperlink{class_a_m_r_level_mushy_layer_a24f8ccde175e9273958d5511b525cdbb}{define()} \end{DoxyCompactList}\item 
void \hyperlink{class_a_m_r_level_mushy_layer_a24f8ccde175e9273958d5511b525cdbb}{define} (\hyperlink{struct_mushy_layer_options}{Mushy\+Layer\+Options} a\+\_\+opt, \hyperlink{class_mushy_layer_params}{Mushy\+Layer\+Params} a\+\_\+params)
\begin{DoxyCompactList}\small\item\em Defines this \hyperlink{class_a_m_r_level_mushy_layer}{A\+M\+R\+Level\+Mushy\+Layer}. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aa642109814b6abb109810d1a14f05541}\label{class_a_m_r_level_mushy_layer_aa642109814b6abb109810d1a14f05541}} 
virtual \hyperlink{class_a_m_r_level_mushy_layer_aa642109814b6abb109810d1a14f05541}{$\sim$\+A\+M\+R\+Level\+Mushy\+Layer} ()
\begin{DoxyCompactList}\small\item\em Destructor. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a4520425f77deb76db6fd3eb789e4c68b}\label{class_a_m_r_level_mushy_layer_a4520425f77deb76db6fd3eb789e4c68b}} 
virtual void \hyperlink{class_a_m_r_level_mushy_layer_a4520425f77deb76db6fd3eb789e4c68b}{define} (\textbf{ A\+M\+R\+Level} $\ast$a\+\_\+coarser\+Level\+Ptr, const \textbf{ Box} \&a\+\_\+problem\+Domain, int a\+\_\+level, int a\+\_\+ref\+Ratio)
\begin{DoxyCompactList}\small\item\em Never called\+: historical. \end{DoxyCompactList}\item 
void \hyperlink{class_a_m_r_level_mushy_layer_ad9766575f35a8fc27568ad7dde975eec}{set\+Defaults} ()
\begin{DoxyCompactList}\small\item\em Set default values. \end{DoxyCompactList}\item 
virtual void \hyperlink{class_a_m_r_level_mushy_layer_a1ed163b80b24d3dc053097d24dc55be5}{define} (\textbf{ A\+M\+R\+Level} $\ast$a\+\_\+coarser\+Level\+Ptr, const \textbf{ Problem\+Domain} \&a\+\_\+problem\+Domain, int a\+\_\+level, int a\+\_\+ref\+Ratio)
\begin{DoxyCompactList}\small\item\em Define new \hyperlink{class_a_m_r_level_mushy_layer}{A\+M\+R\+Level\+Mushy\+Layer} from coarser. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aa303a6233d0a9cf8701035e98e6d028d}\label{class_a_m_r_level_mushy_layer_aa303a6233d0a9cf8701035e98e6d028d}} 
virtual \textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_aa303a6233d0a9cf8701035e98e6d028d}{advance} ()
\begin{DoxyCompactList}\small\item\em Advance by one timestep. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a9c9c444cc77e9f623ddc9132ee4bc532}\label{class_a_m_r_level_mushy_layer_a9c9c444cc77e9f623ddc9132ee4bc532}} 
virtual void \hyperlink{class_a_m_r_level_mushy_layer_a9c9c444cc77e9f623ddc9132ee4bc532}{post\+Time\+Step} ()
\begin{DoxyCompactList}\small\item\em Things to do after a timestep. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a296b5accca2569adda4f91b90f0213e0}\label{class_a_m_r_level_mushy_layer_a296b5accca2569adda4f91b90f0213e0}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a296b5accca2569adda4f91b90f0213e0}{do\+Explicit\+Reflux} (int a\+\_\+var)
\begin{DoxyCompactList}\small\item\em Explicitly reflux scalar field. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ad6c20b4a85790c49eab030f6909a0a0b}\label{class_a_m_r_level_mushy_layer_ad6c20b4a85790c49eab030f6909a0a0b}} 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_ad6c20b4a85790c49eab030f6909a0a0b}{do\+H\+Creflux} ()
\begin{DoxyCompactList}\small\item\em Reflux enthalpy and bulk concentration. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aee6c4114796ab78aaa088d65e8e749d6}\label{class_a_m_r_level_mushy_layer_aee6c4114796ab78aaa088d65e8e749d6}} 
void \hyperlink{class_a_m_r_level_mushy_layer_aee6c4114796ab78aaa088d65e8e749d6}{do\+Momentum\+Reflux} (\textbf{ Vector}$<$ \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ $\ast$$>$ \&comp\+Vel)
\begin{DoxyCompactList}\small\item\em Do reflux on momentum field. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aff274f3682a706271fc3a26eefb0be20}\label{class_a_m_r_level_mushy_layer_aff274f3682a706271fc3a26eefb0be20}} 
virtual void \hyperlink{class_a_m_r_level_mushy_layer_aff274f3682a706271fc3a26eefb0be20}{tag\+Cells} (\textbf{ Int\+Vect\+Set} \&a\+\_\+tags)
\begin{DoxyCompactList}\small\item\em Create tags for regridding. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a3bfdf4f5d7260b8f6f834777ce8a7650}\label{class_a_m_r_level_mushy_layer_a3bfdf4f5d7260b8f6f834777ce8a7650}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a3bfdf4f5d7260b8f6f834777ce8a7650}{tag\+Mush\+Liquid\+Boundary} (\textbf{ Int\+Vect\+Set} \&local\+Tags)
\begin{DoxyCompactList}\small\item\em Tags cells on the mush side of the mush-\/liquid boundary. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a4581ecc244c826a19c696e5b8d01abf3}\label{class_a_m_r_level_mushy_layer_a4581ecc244c826a19c696e5b8d01abf3}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a4581ecc244c826a19c696e5b8d01abf3}{tag\+Boundary\+Layer\+Cells} (\textbf{ Int\+Vect\+Set} \&local\+Tags)
\begin{DoxyCompactList}\small\item\em Tag cells on the domain boundary. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a6eee1db20d8b07c958a1e19af1dbbe4a}\label{class_a_m_r_level_mushy_layer_a6eee1db20d8b07c958a1e19af1dbbe4a}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a6eee1db20d8b07c958a1e19af1dbbe4a}{tag\+Center\+Cells} (\textbf{ Int\+Vect\+Set} \&local\+Tags, \textbf{ Real} radius=0)
\begin{DoxyCompactList}\small\item\em Tag cells inside grid. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a921f860820c88cc804345a20c2bd596d}\label{class_a_m_r_level_mushy_layer_a921f860820c88cc804345a20c2bd596d}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a921f860820c88cc804345a20c2bd596d}{tag\+Mushy\+Cells} (\textbf{ Int\+Vect\+Set} \&local\+Tags)
\begin{DoxyCompactList}\small\item\em Tag cells with porosity $<$ 1. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a8156d0f61bb70c5564bacda25f6464aa}\label{class_a_m_r_level_mushy_layer_a8156d0f61bb70c5564bacda25f6464aa}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a8156d0f61bb70c5564bacda25f6464aa}{tag\+Cells\+Var} (\textbf{ Int\+Vect\+Set} \&local\+Tags, \textbf{ Real} refine\+Thresh, int tagging\+Var, int vector\+Tagging\+Var, \hyperlink{mushy_layer_opt_8h_ab82ea28e90e93c3551db99693337d71c}{Tagging\+Method} tagging\+Method, int comp=-\/1)
\begin{DoxyCompactList}\small\item\em Add cells that specify criteria. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a914c405e621143eed2da6da1bcae2604}\label{class_a_m_r_level_mushy_layer_a914c405e621143eed2da6da1bcae2604}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a914c405e621143eed2da6da1bcae2604}{level\+Setup} ()
\begin{DoxyCompactList}\small\item\em Setup menagerie of data structures. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ae544a65079355f9d4e27768f2b7c8c7e}\label{class_a_m_r_level_mushy_layer_ae544a65079355f9d4e27768f2b7c8c7e}} 
void \hyperlink{class_a_m_r_level_mushy_layer_ae544a65079355f9d4e27768f2b7c8c7e}{define\+C\+F\+Interp} ()
\begin{DoxyCompactList}\small\item\em Setup CF interp objects. \end{DoxyCompactList}\item 
void \hyperlink{class_a_m_r_level_mushy_layer_a5064704173348a8efa158f400983a101}{set\+Eta} (\textbf{ Real} a\+\_\+eta)
\begin{DoxyCompactList}\small\item\em Set eta on all projection operators. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a2771f661ce974eec626324cf2b07fd59}\label{class_a_m_r_level_mushy_layer_a2771f661ce974eec626324cf2b07fd59}} 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_a2771f661ce974eec626324cf2b07fd59}{max\+Allowed\+Eta} ()
\begin{DoxyCompactList}\small\item\em Maximum allowed eta. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ac44c7ebcf787be031046fb732ac4aa96}\label{class_a_m_r_level_mushy_layer_ac44c7ebcf787be031046fb732ac4aa96}} 
void \hyperlink{class_a_m_r_level_mushy_layer_ac44c7ebcf787be031046fb732ac4aa96}{set\+Adv\+Vel\+Centering} (\textbf{ Real} a\+\_\+fraction)
\begin{DoxyCompactList}\small\item\em Set adv\+\_\+vel\+\_\+centering on all levels. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a3239fcf9157c4b6174aba461e4e4b327}\label{class_a_m_r_level_mushy_layer_a3239fcf9157c4b6174aba461e4e4b327}} 
virtual void \hyperlink{class_a_m_r_level_mushy_layer_a3239fcf9157c4b6174aba461e4e4b327}{tag\+Cells\+Init} (\textbf{ Int\+Vect\+Set} \&a\+\_\+tags)
\begin{DoxyCompactList}\small\item\em Create tags at initialization. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a92be42a12813c7e9bebb3ab6f025616f}\label{class_a_m_r_level_mushy_layer_a92be42a12813c7e9bebb3ab6f025616f}} 
virtual void \hyperlink{class_a_m_r_level_mushy_layer_a92be42a12813c7e9bebb3ab6f025616f}{regrid} (const \textbf{ Vector}$<$ \textbf{ Box} $>$ \&a\+\_\+new\+Grids)
\begin{DoxyCompactList}\small\item\em Set up data on this level after regridding. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_adc885cc04926a87b4c4f97e3803fc749}\label{class_a_m_r_level_mushy_layer_adc885cc04926a87b4c4f97e3803fc749}} 
virtual void \hyperlink{class_a_m_r_level_mushy_layer_adc885cc04926a87b4c4f97e3803fc749}{initial\+Grid} (const \textbf{ Vector}$<$ \textbf{ Box} $>$ \&a\+\_\+new\+Grids)
\begin{DoxyCompactList}\small\item\em Initialize grids. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a7d430606668cadfa432d81d521d5cf79}\label{class_a_m_r_level_mushy_layer_a7d430606668cadfa432d81d521d5cf79}} 
virtual void \hyperlink{class_a_m_r_level_mushy_layer_a7d430606668cadfa432d81d521d5cf79}{post\+Initial\+Grid} (const bool a\+\_\+restart)
\begin{DoxyCompactList}\small\item\em Operations to do after initial grids have been set up. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a9b299b200bf4fadfb4ad7221177d4585}\label{class_a_m_r_level_mushy_layer_a9b299b200bf4fadfb4ad7221177d4585}} 
virtual void \hyperlink{class_a_m_r_level_mushy_layer_a9b299b200bf4fadfb4ad7221177d4585}{post\+Regrid} (int a\+\_\+base\+\_\+level)
\begin{DoxyCompactList}\small\item\em Operations to execute after we\textquotesingle{}ve done regridding. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a6763c8a7fef3e4f0c5da3c90df096e98}\label{class_a_m_r_level_mushy_layer_a6763c8a7fef3e4f0c5da3c90df096e98}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a6763c8a7fef3e4f0c5da3c90df096e98}{create\+Data\+Structures} ()
\begin{DoxyCompactList}\small\item\em Create structures to hold data. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ac0291e7b321a6f26a057dfd2d6fb9466}\label{class_a_m_r_level_mushy_layer_ac0291e7b321a6f26a057dfd2d6fb9466}} 
void \hyperlink{class_a_m_r_level_mushy_layer_ac0291e7b321a6f26a057dfd2d6fb9466}{init\+Data\+Structures} ()
\begin{DoxyCompactList}\small\item\em Initialize data structures -\/ resize arrays etc. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a8dcd4deaca137c36c34b377c1f27d8af}\label{class_a_m_r_level_mushy_layer_a8dcd4deaca137c36c34b377c1f27d8af}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a8dcd4deaca137c36c34b377c1f27d8af}{compute\+All\+Velocities} (bool do\+F\+Rupdates)
\begin{DoxyCompactList}\small\item\em Compute cell-\/centred and face-\/centred velocities. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_adae77fea47630fd1e3c2dea1c59e4c3a}\label{class_a_m_r_level_mushy_layer_adae77fea47630fd1e3c2dea1c59e4c3a}} 
virtual void \hyperlink{class_a_m_r_level_mushy_layer_adae77fea47630fd1e3c2dea1c59e4c3a}{initial\+Data} ()
\begin{DoxyCompactList}\small\item\em Initialize data. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ae1b467d34bd12136bab9f15b2186fd56}\label{class_a_m_r_level_mushy_layer_ae1b467d34bd12136bab9f15b2186fd56}} 
void \hyperlink{class_a_m_r_level_mushy_layer_ae1b467d34bd12136bab9f15b2186fd56}{initial\+Data\+Corner\+Flow} ()
\begin{DoxyCompactList}\small\item\em Initial data for corner flow problem. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a3018e7aa05879f67daa66025f1a5dc02}\label{class_a_m_r_level_mushy_layer_a3018e7aa05879f67daa66025f1a5dc02}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a3018e7aa05879f67daa66025f1a5dc02}{initial\+Data\+H\+RL} ()
\begin{DoxyCompactList}\small\item\em Initial data for Horton-\/\+Rogers-\/\+Lapwood problem. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a3b71c86932fba19e9ff28e40503bc299}\label{class_a_m_r_level_mushy_layer_a3b71c86932fba19e9ff28e40503bc299}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a3b71c86932fba19e9ff28e40503bc299}{initial\+Data\+Convection\+Mixed\+Porous} ()
\begin{DoxyCompactList}\small\item\em Initial data for convection in a hetrogeneous porous medium. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a19fb2e0f21a8e3f92e6a6f4622dd9654}\label{class_a_m_r_level_mushy_layer_a19fb2e0f21a8e3f92e6a6f4622dd9654}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a19fb2e0f21a8e3f92e6a6f4622dd9654}{initial\+Data\+Poiseuille} ()
\begin{DoxyCompactList}\small\item\em Initial data for poiseuille flow. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_af0a22602d233dba91f217a4a2a9136b3}\label{class_a_m_r_level_mushy_layer_af0a22602d233dba91f217a4a2a9136b3}} 
void \hyperlink{class_a_m_r_level_mushy_layer_af0a22602d233dba91f217a4a2a9136b3}{initial\+Data\+Ice\+Block} ()
\begin{DoxyCompactList}\small\item\em Initial data for a solid ice block. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a601849adc5f5b5fc9e9999b568020922}\label{class_a_m_r_level_mushy_layer_a601849adc5f5b5fc9e9999b568020922}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a601849adc5f5b5fc9e9999b568020922}{initial\+Data\+Mushy\+Layer} ()
\begin{DoxyCompactList}\small\item\em Initial data for mushy layer simulations. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a6a97be276431431a0d0338476f837f5c}\label{class_a_m_r_level_mushy_layer_a6a97be276431431a0d0338476f837f5c}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a6a97be276431431a0d0338476f837f5c}{initial\+Data\+Porous\+Hole} ()
\begin{DoxyCompactList}\small\item\em Mushy layer with a porous hole in the middle. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a68a589a8bddf6c0ef6a0ef4987c1e1ce}\label{class_a_m_r_level_mushy_layer_a68a589a8bddf6c0ef6a0ef4987c1e1ce}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a68a589a8bddf6c0ef6a0ef4987c1e1ce}{initial\+Data\+Zero\+Porosity\+Test} ()
\begin{DoxyCompactList}\small\item\em Initial data for a test case with regions of zero porosity. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ab258a56bea5c0a889040d751c074f1ce}\label{class_a_m_r_level_mushy_layer_ab258a56bea5c0a889040d751c074f1ce}} 
void \hyperlink{class_a_m_r_level_mushy_layer_ab258a56bea5c0a889040d751c074f1ce}{initial\+Data\+Diffusion} ()
\begin{DoxyCompactList}\small\item\em Initial data for diffusion problem. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a2890289b25f3e4ea6b698ddb0d6b9223}\label{class_a_m_r_level_mushy_layer_a2890289b25f3e4ea6b698ddb0d6b9223}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a2890289b25f3e4ea6b698ddb0d6b9223}{initial\+Data\+Vortex\+Pair} ()
\begin{DoxyCompactList}\small\item\em Initial data for vortex pair problem. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aa17f3ed72486c33689944f8c9ec5cce1}\label{class_a_m_r_level_mushy_layer_aa17f3ed72486c33689944f8c9ec5cce1}} 
void \hyperlink{class_a_m_r_level_mushy_layer_aa17f3ed72486c33689944f8c9ec5cce1}{add\+Vortex} (\textbf{ Real\+Vect} center, \textbf{ Real} strength, \textbf{ Real} radius)
\begin{DoxyCompactList}\small\item\em Add vortex to domain. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a376041439f9a4d8a2d62fbbd199f81f5}\label{class_a_m_r_level_mushy_layer_a376041439f9a4d8a2d62fbbd199f81f5}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a376041439f9a4d8a2d62fbbd199f81f5}{initial\+Data\+Rayleigh\+Benard} ()
\begin{DoxyCompactList}\small\item\em Initial data for Rayleigh-\/\+Benard problem. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a36fcaecdd8d8033bdfb0d3492df1be20}\label{class_a_m_r_level_mushy_layer_a36fcaecdd8d8033bdfb0d3492df1be20}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a36fcaecdd8d8033bdfb0d3492df1be20}{initial\+Data\+Solute\+Flux} ()
\begin{DoxyCompactList}\small\item\em Initial data for solute flux test problem. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a975f7e7062b5944e9e13c3d13fc27115}\label{class_a_m_r_level_mushy_layer_a975f7e7062b5944e9e13c3d13fc27115}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a975f7e7062b5944e9e13c3d13fc27115}{initial\+Data\+Sidewall\+Heating} ()
\begin{DoxyCompactList}\small\item\em Initial data for sidewall heating problem. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ac1ca84bc06a3c5bc314994cc24d4bca7}\label{class_a_m_r_level_mushy_layer_ac1ca84bc06a3c5bc314994cc24d4bca7}} 
void \hyperlink{class_a_m_r_level_mushy_layer_ac1ca84bc06a3c5bc314994cc24d4bca7}{initial\+Data\+Default} ()
\begin{DoxyCompactList}\small\item\em Default initial data. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aeb53defbc82746d0570b7d39e6aa5b8f}\label{class_a_m_r_level_mushy_layer_aeb53defbc82746d0570b7d39e6aa5b8f}} 
void \hyperlink{class_a_m_r_level_mushy_layer_aeb53defbc82746d0570b7d39e6aa5b8f}{initial\+Data\+Burgers} ()
\begin{DoxyCompactList}\small\item\em Initial data for burgers problem. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_adb8038e986c8d16f3116e267f2532409}\label{class_a_m_r_level_mushy_layer_adb8038e986c8d16f3116e267f2532409}} 
void \hyperlink{class_a_m_r_level_mushy_layer_adb8038e986c8d16f3116e267f2532409}{initial\+Data\+Reflux\+Test} ()
\begin{DoxyCompactList}\small\item\em Initial data for problem to test refluxing. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aedf04d8f404368144387557105e0dcc2}\label{class_a_m_r_level_mushy_layer_aedf04d8f404368144387557105e0dcc2}} 
bool \hyperlink{class_a_m_r_level_mushy_layer_aedf04d8f404368144387557105e0dcc2}{load\+Adv\+Vel} ()
\begin{DoxyCompactList}\small\item\em Whether or not we\textquotesingle{}re loading advection velocities. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a0b73c4a7644eea767d6cf1d16676809d}\label{class_a_m_r_level_mushy_layer_a0b73c4a7644eea767d6cf1d16676809d}} 
virtual bool \hyperlink{class_a_m_r_level_mushy_layer_a0b73c4a7644eea767d6cf1d16676809d}{converged\+To\+Steady\+State} ()
\begin{DoxyCompactList}\small\item\em Have we converged to steady state? \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a596d008b356f29abf0973a88136739a9}\label{class_a_m_r_level_mushy_layer_a596d008b356f29abf0973a88136739a9}} 
virtual void \hyperlink{class_a_m_r_level_mushy_layer_a596d008b356f29abf0973a88136739a9}{post\+Initialize} ()
\begin{DoxyCompactList}\small\item\em Things to do after initialization. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ac26973f409362a3b1aae6828737afbb3}\label{class_a_m_r_level_mushy_layer_ac26973f409362a3b1aae6828737afbb3}} 
void \hyperlink{class_a_m_r_level_mushy_layer_ac26973f409362a3b1aae6828737afbb3}{compute\+Vorticity\+Streamfunction} ()
\begin{DoxyCompactList}\small\item\em Calculate vorticity and streamfunction so we can plot them. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a559c35e8c90e8da2003dac3aa6cbdf8e}\label{class_a_m_r_level_mushy_layer_a559c35e8c90e8da2003dac3aa6cbdf8e}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a559c35e8c90e8da2003dac3aa6cbdf8e}{compute\+Vorticity} ()
\begin{DoxyCompactList}\small\item\em Compute vorticity. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a318160aa2298ae805cbb19b5f2a7f750}\label{class_a_m_r_level_mushy_layer_a318160aa2298ae805cbb19b5f2a7f750}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a318160aa2298ae805cbb19b5f2a7f750}{get\+Extra\+Plot\+Fields} ()
\begin{DoxyCompactList}\small\item\em Get $ \pi $ and $ \phi $ from projection so we can plot them. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_abedf24a1dd03d1de3c42222da1fcac3d}\label{class_a_m_r_level_mushy_layer_abedf24a1dd03d1de3c42222da1fcac3d}} 
void \hyperlink{class_a_m_r_level_mushy_layer_abedf24a1dd03d1de3c42222da1fcac3d}{write\+A\+M\+R\+Hierarchy} (string filename)
\begin{DoxyCompactList}\small\item\em Write \textbf{ A\+MR} hierarchy to file. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a933a793c507559e99588e74cf4991cc6}\label{class_a_m_r_level_mushy_layer_a933a793c507559e99588e74cf4991cc6}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a933a793c507559e99588e74cf4991cc6}{set\+Dimensionless\+Reference\+Initial} ()
\begin{DoxyCompactList}\small\item\em Set reference point for nondimensionalisation to be the initial temperature/salinity. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ad72c0829630fc595941dc313c09c2667}\label{class_a_m_r_level_mushy_layer_ad72c0829630fc595941dc313c09c2667}} 
void \hyperlink{class_a_m_r_level_mushy_layer_ad72c0829630fc595941dc313c09c2667}{set\+Dimensionless\+Reference\+Eutectic} ()
\begin{DoxyCompactList}\small\item\em Set reference point for nondimensionalisation to be the eutectic temperature/salinity. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a3918643e41cb27879557d6cf06ac2f2b}\label{class_a_m_r_level_mushy_layer_a3918643e41cb27879557d6cf06ac2f2b}} 
virtual \textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_a3918643e41cb27879557d6cf06ac2f2b}{compute\+Dt} ()
\begin{DoxyCompactList}\small\item\em Returns the dt computed earlier for this level. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_af9995d5aaa7f7ce624b934ba3ad9306c}\label{class_a_m_r_level_mushy_layer_af9995d5aaa7f7ce624b934ba3ad9306c}} 
virtual \textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_af9995d5aaa7f7ce624b934ba3ad9306c}{compute\+Initial\+Dt} ()
\begin{DoxyCompactList}\small\item\em Compute dt using initial data. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ac4dc44ed82584911b5d702070f493c73}\label{class_a_m_r_level_mushy_layer_ac4dc44ed82584911b5d702070f493c73}} 
void \hyperlink{class_a_m_r_level_mushy_layer_ac4dc44ed82584911b5d702070f493c73}{compute\+Diagnostics} ()
\begin{DoxyCompactList}\small\item\em Compute nusselt number, salt fluxes etc. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a4496757ba2d136d3acfc3b37538d8a27}\label{class_a_m_r_level_mushy_layer_a4496757ba2d136d3acfc3b37538d8a27}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a4496757ba2d136d3acfc3b37538d8a27}{define\+Solvers} (\textbf{ Real} a\+\_\+time)
\begin{DoxyCompactList}\small\item\em Define solvers. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_af1f23fee3ffae8ab4a84caae3a87c4fc}\label{class_a_m_r_level_mushy_layer_af1f23fee3ffae8ab4a84caae3a87c4fc}} 
void \hyperlink{class_a_m_r_level_mushy_layer_af1f23fee3ffae8ab4a84caae3a87c4fc}{compute\+Chimney\+Diagnostics} ()
\begin{DoxyCompactList}\small\item\em Compute chimney diagnostics. \end{DoxyCompactList}\item 
\textbf{ Disjoint\+Box\+Layout} \hyperlink{class_a_m_r_level_mushy_layer_afbb2adb1dd99e2b69bcb58d5395fe3b5}{grids} ()
\begin{DoxyCompactList}\small\item\em Whether or not to compute diagnostics. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a03805c646cd80400874095a6960545cd}\label{class_a_m_r_level_mushy_layer_a03805c646cd80400874095a6960545cd}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a03805c646cd80400874095a6960545cd}{shift\+Data} (int dir, int distance)
\begin{DoxyCompactList}\small\item\em Shift data in domain. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ab8b44ec14b5ddfb4d42358ae2a2f72ea}\label{class_a_m_r_level_mushy_layer_ab8b44ec14b5ddfb4d42358ae2a2f72ea}} 
void \hyperlink{class_a_m_r_level_mushy_layer_ab8b44ec14b5ddfb4d42358ae2a2f72ea}{dx} (\textbf{ Real} new\+Dx)
\begin{DoxyCompactList}\small\item\em Set $ \Delta x $ on this level. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aba9f93626a8ad8c99c98c82a2a539e30}\label{class_a_m_r_level_mushy_layer_aba9f93626a8ad8c99c98c82a2a539e30}} 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_aba9f93626a8ad8c99c98c82a2a539e30}{dx} ()
\begin{DoxyCompactList}\small\item\em Get $ \Delta x $ on this level. \end{DoxyCompactList}\item 
void \hyperlink{class_a_m_r_level_mushy_layer_a8032590f0d7a8160dc1a56151648f7c8}{reshape\+Data} (\textbf{ Disjoint\+Box\+Layout} new\+Grids, \textbf{ Problem\+Domain} new\+Domain)
\begin{DoxyCompactList}\small\item\em Transfer data to new disjoint box layout. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a1afe0bf8c7646e56849d90da107afe1d}\label{class_a_m_r_level_mushy_layer_a1afe0bf8c7646e56849d90da107afe1d}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a1afe0bf8c7646e56849d90da107afe1d}{refine} (\textbf{ Real} ref\+\_\+ratio, \textbf{ Disjoint\+Box\+Layout} a\+\_\+grids, \textbf{ Problem\+Domain} a\+\_\+domain)
\begin{DoxyCompactList}\small\item\em Refine data. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aaeccaad92142479afdc82e3b127be495}\label{class_a_m_r_level_mushy_layer_aaeccaad92142479afdc82e3b127be495}} 
void \hyperlink{class_a_m_r_level_mushy_layer_aaeccaad92142479afdc82e3b127be495}{do\+Post\+Regrid\+Smoothing} (bool a\+\_\+smooth\+Vel=true, bool a\+\_\+smooth\+Scalar=true)
\begin{DoxyCompactList}\small\item\em Do smoothing after regridding. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a3c89f5bbdbe135424e8cdfd75fc03061}\label{class_a_m_r_level_mushy_layer_a3c89f5bbdbe135424e8cdfd75fc03061}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a3c89f5bbdbe135424e8cdfd75fc03061}{set\+Smoothing\+Coeff} (\textbf{ Real} a\+\_\+coeff)
\begin{DoxyCompactList}\small\item\em Set the coefficient for smoothing fields. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a53fdab32dfd433f2c737e414f2912d22}\label{class_a_m_r_level_mushy_layer_a53fdab32dfd433f2c737e414f2912d22}} 
void {\bfseries set\+Smoothing\+Done} (bool a\+\_\+smoothing\+Done)
\item 
void \hyperlink{class_a_m_r_level_mushy_layer_aa2aeb21dddb01b6406407104dd66c09b}{add\+Melt\+Pond} (int depth, \textbf{ Real} salinity, \textbf{ Real} enthalpy, bool rescale\+Existing\+Solution=false)
\begin{DoxyCompactList}\small\item\em Add a melt pond at the top of the domain. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aca6ded080c70e8ea040576861d832e09}\label{class_a_m_r_level_mushy_layer_aca6ded080c70e8ea040576861d832e09}} 
void \hyperlink{class_a_m_r_level_mushy_layer_aca6ded080c70e8ea040576861d832e09}{set\+Vel\+Zero} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+vel, \textbf{ Real} a\+\_\+limit=-\/1, int a\+\_\+radius=0)
\begin{DoxyCompactList}\small\item\em Make sure zero porosity regions have no velocity (cell centred velocity) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a14cee19cc957db8f3cce3e09fca9edf3}\label{class_a_m_r_level_mushy_layer_a14cee19cc957db8f3cce3e09fca9edf3}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a14cee19cc957db8f3cce3e09fca9edf3}{set\+Vel\+Zero} (\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+vel, \textbf{ Real} a\+\_\+limit=-\/1)
\begin{DoxyCompactList}\small\item\em Make sure zero porosity regions have no velocity (face centred velocity) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ae3dcf62f2464245d7a3035cd1508061f}\label{class_a_m_r_level_mushy_layer_ae3dcf62f2464245d7a3035cd1508061f}} 
void \hyperlink{class_a_m_r_level_mushy_layer_ae3dcf62f2464245d7a3035cd1508061f}{set\+C\+C\+Vel\+Zero} (\textbf{ Real} a\+\_\+limit)
\begin{DoxyCompactList}\small\item\em Set velocity to zero when porosity is below specified limit (cell centred) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a8679a53e5cbddc3af173ea3ff5b574de}\label{class_a_m_r_level_mushy_layer_a8679a53e5cbddc3af173ea3ff5b574de}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a8679a53e5cbddc3af173ea3ff5b574de}{update\+Enthalpy\+Variables} ()
\begin{DoxyCompactList}\small\item\em Update thermodynamic variables based on phase diagram. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a2e827a3ed1a3ced10f1b47bb0014731b}\label{class_a_m_r_level_mushy_layer_a2e827a3ed1a3ced10f1b47bb0014731b}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a2e827a3ed1a3ced10f1b47bb0014731b}{compute\+Lambda\+Porosity} ()
\begin{DoxyCompactList}\small\item\em Compute lambda/porosity. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a3e7c81e2b518526f09df6ba4f05b8a30}\label{class_a_m_r_level_mushy_layer_a3e7c81e2b518526f09df6ba4f05b8a30}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a3e7c81e2b518526f09df6ba4f05b8a30}{set\+\_\+compute\+\_\+diagnostics} (bool compute\+\_\+diags)
\begin{DoxyCompactList}\small\item\em Set whether or not to compute diagnostics. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a274e94808bae902de953586885151ea3}\label{class_a_m_r_level_mushy_layer_a274e94808bae902de953586885151ea3}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a274e94808bae902de953586885151ea3}{horiz\+Average} ()
\begin{DoxyCompactList}\small\item\em Average enthalpy and bulk salinity then recalculate all other fields. \end{DoxyCompactList}\item 
void \hyperlink{class_a_m_r_level_mushy_layer_aea3d5cfb654cc0e1e0f14bea830add39}{smooth\+Scalar\+Field} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+phi, int a\+\_\+var, \textbf{ Real} a\+\_\+smoothing)
\begin{DoxyCompactList}\small\item\em Smooth some scalar field. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a52a50ea237ec2a7d02af1410a5f771a6}\label{class_a_m_r_level_mushy_layer_a52a50ea237ec2a7d02af1410a5f771a6}} 
void {\bfseries smooth\+Enthalpy\+Bulk\+Conc} (\textbf{ Real} a\+\_\+smoothing)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a280fdf87f2f58ddc25250fff6b6c9f19}\label{class_a_m_r_level_mushy_layer_a280fdf87f2f58ddc25250fff6b6c9f19}} 
\hyperlink{class_diagnostics}{Diagnostics} \hyperlink{class_a_m_r_level_mushy_layer_a280fdf87f2f58ddc25250fff6b6c9f19}{m\+\_\+diagnostics}
\begin{DoxyCompactList}\small\item\em \hyperlink{class_diagnostics}{Diagnostics} e.\+g. Nusselt number, solute flux. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Types}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{class_a_m_r_level_mushy_layer_ae580be53bf92a5bad64ba0032282458b}{solver\+Restart} \{ \hyperlink{class_a_m_r_level_mushy_layer_ae580be53bf92a5bad64ba0032282458bae62a0ef77c0cf96f38983824de51f8d5}{m\+\_\+restart\+Halve\+Dt}, 
\hyperlink{class_a_m_r_level_mushy_layer_ae580be53bf92a5bad64ba0032282458ba0d29913c8280770cbd3501f7d3f0963a}{m\+\_\+restart\+Reset\+Data}
 \}\begin{DoxyCompactList}\small\item\em What to do when restarting after a failed timestep. \end{DoxyCompactList}
\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aad8e3d2cda90acb68c1086e0e08096a6}\label{class_a_m_r_level_mushy_layer_aad8e3d2cda90acb68c1086e0e08096a6}} 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_aad8e3d2cda90acb68c1086e0e08096a6}{converged\+To\+Steady\+State} (const int a\+\_\+var, bool vector=false)
\begin{DoxyCompactList}\small\item\em Has a particular variable converged to steady state? \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a0f76ac50feba2ebcf8cd431948690a76}\label{class_a_m_r_level_mushy_layer_a0f76ac50feba2ebcf8cd431948690a76}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a0f76ac50feba2ebcf8cd431948690a76}{compute\+\_\+d\+\_\+dt} (const int a\+\_\+var, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&diff, bool vector=false)
\begin{DoxyCompactList}\small\item\em Compute $ \partial / \partial t $ of some field. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ab86dcb9c77a0696fbb3fbc7d6a1d09b3}\label{class_a_m_r_level_mushy_layer_ab86dcb9c77a0696fbb3fbc7d6a1d09b3}} 
bool \hyperlink{class_a_m_r_level_mushy_layer_ab86dcb9c77a0696fbb3fbc7d6a1d09b3}{solving\+Full\+Darcy\+Brinkman} ()
\begin{DoxyCompactList}\small\item\em Determine if we\textquotesingle{}re solving the full time dependent equation, or just darcy\textquotesingle{}s law. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a540bac726905fcc0af2fcfe7a8b7fed1}\label{class_a_m_r_level_mushy_layer_a540bac726905fcc0af2fcfe7a8b7fed1}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a540bac726905fcc0af2fcfe7a8b7fed1}{update\+Enthalpy\+Variables\+Old} ()
\begin{DoxyCompactList}\small\item\em Update thermodynamic variables based on phase diagram (old time) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ad978d1a9a28c1ef557aa348807534eb4}\label{class_a_m_r_level_mushy_layer_ad978d1a9a28c1ef557aa348807534eb4}} 
bool \hyperlink{class_a_m_r_level_mushy_layer_ad978d1a9a28c1ef557aa348807534eb4}{finest\+Level} ()
\begin{DoxyCompactList}\small\item\em Returns true if there is not a finer level with a grid defined on it. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a52cfb93ecc1e44063a1db80fb417017b}\label{class_a_m_r_level_mushy_layer_a52cfb93ecc1e44063a1db80fb417017b}} 
int \hyperlink{class_a_m_r_level_mushy_layer_a52cfb93ecc1e44063a1db80fb417017b}{get\+Finest\+Level} ()
\begin{DoxyCompactList}\small\item\em Return the finest level. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a38c3d474a125f8cf66dd07e08ee02709}\label{class_a_m_r_level_mushy_layer_a38c3d474a125f8cf66dd07e08ee02709}} 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_a38c3d474a125f8cf66dd07e08ee02709}{compute\+Dt} (\textbf{ Real} cfl)
\begin{DoxyCompactList}\small\item\em Returns $ \Delta t $. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aa758dba965ec2072e89a8bb75620db1b}\label{class_a_m_r_level_mushy_layer_aa758dba965ec2072e89a8bb75620db1b}} 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_aa758dba965ec2072e89a8bb75620db1b}{get\+Max\+Velocity} ()
\begin{DoxyCompactList}\small\item\em Get largest velocity in domain. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a3b410905a30aedc8bff12dd252e8ed6c}\label{class_a_m_r_level_mushy_layer_a3b410905a30aedc8bff12dd252e8ed6c}} 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_a3b410905a30aedc8bff12dd252e8ed6c}{get\+Max\+Velocity\+For\+C\+FL} ()
\begin{DoxyCompactList}\small\item\em get largest advection velocity, considering $ \mathbf{U}/\chi $ if appropriate \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a5c70eeffd6fc54e52bfa1eda2bf2a9fe}\label{class_a_m_r_level_mushy_layer_a5c70eeffd6fc54e52bfa1eda2bf2a9fe}} 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_a5c70eeffd6fc54e52bfa1eda2bf2a9fe}{compute\+Max\+U\+Chi} ()
\begin{DoxyCompactList}\small\item\em Compute max $ \mathbf{U}/\chi $. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ad43025c8b7491a8d8b0c125218b7d674}\label{class_a_m_r_level_mushy_layer_ad43025c8b7491a8d8b0c125218b7d674}} 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_ad43025c8b7491a8d8b0c125218b7d674}{get\+Max\+Adv\+Vel} ()
\begin{DoxyCompactList}\small\item\em Get max advection velocity. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a3eee3de4d8921d0778ed037698c5d5c4}\label{class_a_m_r_level_mushy_layer_a3eee3de4d8921d0778ed037698c5d5c4}} 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_a3eee3de4d8921d0778ed037698c5d5c4}{compute\+Dt} (bool growdt)
\begin{DoxyCompactList}\small\item\em Returns $ \Delta t $. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_adaba898a184c0cd44d6d1b12f52ef503}\label{class_a_m_r_level_mushy_layer_adaba898a184c0cd44d6d1b12f52ef503}} 
void \hyperlink{class_a_m_r_level_mushy_layer_adaba898a184c0cd44d6d1b12f52ef503}{restart\+Timestep\+From\+Backup} (bool ignore\+Pressure=false)
\begin{DoxyCompactList}\small\item\em Replace with data from before the last backup. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a165220ab8589f345f78556bf427e3745}\label{class_a_m_r_level_mushy_layer_a165220ab8589f345f78556bf427e3745}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a165220ab8589f345f78556bf427e3745}{backup\+Timestep} ()
\begin{DoxyCompactList}\small\item\em Save the current data. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ae7e0fe54da114a5783449790de226ae6}\label{class_a_m_r_level_mushy_layer_ae7e0fe54da114a5783449790de226ae6}} 
void \hyperlink{class_a_m_r_level_mushy_layer_ae7e0fe54da114a5783449790de226ae6}{get\+Hierarchy\+And\+Grids} (\textbf{ Vector}$<$ \hyperlink{class_a_m_r_level_mushy_layer}{A\+M\+R\+Level\+Mushy\+Layer} $\ast$$>$ \&a\+\_\+hierarchy, \textbf{ Vector}$<$ \textbf{ Disjoint\+Box\+Layout} $>$ \&a\+\_\+grids, \textbf{ Vector}$<$ int $>$ \&a\+\_\+ref\+Rat, \textbf{ Problem\+Domain} \&a\+\_\+lev0\+Dom, \textbf{ Real} \&a\+\_\+lev0\+Dx)
\begin{DoxyCompactList}\small\item\em Get information on the entire \textbf{ A\+MR} hierarchy. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aef9f77f57da892bd8930943bfbec9a6b}\label{class_a_m_r_level_mushy_layer_aef9f77f57da892bd8930943bfbec9a6b}} 
void \hyperlink{class_a_m_r_level_mushy_layer_aef9f77f57da892bd8930943bfbec9a6b}{calculate\+Permeability} ()
\begin{DoxyCompactList}\small\item\em Calculate permeability $ \Pi $. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a3b0111c15c91c012d328e42b43fa954f}\label{class_a_m_r_level_mushy_layer_a3b0111c15c91c012d328e42b43fa954f}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a3b0111c15c91c012d328e42b43fa954f}{calculate\+Coarse\+Fine\+Boundaries} (int a\+\_\+var, bool vector=false)
\begin{DoxyCompactList}\small\item\em Fills coarse-\/fine boundaries on variable by quadratic interpolation. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_adc086e9a094b35435de36aadb3891ab7}\label{class_a_m_r_level_mushy_layer_adc086e9a094b35435de36aadb3891ab7}} 
int \hyperlink{class_a_m_r_level_mushy_layer_adc086e9a094b35435de36aadb3891ab7}{multi\+Comp\+Advect\+Diffuse} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+phi\+\_\+old, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+phi\+\_\+new, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+src, bool do\+F\+Rupdates=false, bool compute\+Advective\+Src=true)
\begin{DoxyCompactList}\small\item\em Advection diffusion for multiple components. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_af640c8b9d905e16e6b90b6c4f1c7fda2}\label{class_a_m_r_level_mushy_layer_af640c8b9d905e16e6b90b6c4f1c7fda2}} 
void \hyperlink{class_a_m_r_level_mushy_layer_af640c8b9d905e16e6b90b6c4f1c7fda2}{compute\+Scalar\+Advective\+Src} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+src, int a\+\_\+var, bool converged, int a\+\_\+comp=0)
\begin{DoxyCompactList}\small\item\em Compute src term and add it to a\+\_\+src. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ab376d561af9e6d98881d71bb00184b7f}\label{class_a_m_r_level_mushy_layer_ab376d561af9e6d98881d71bb00184b7f}} 
void \hyperlink{class_a_m_r_level_mushy_layer_ab376d561af9e6d98881d71bb00184b7f}{compute\+Scalar\+Advective\+Src\+HC} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+src, \textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&edge\+Scal\+Total, bool converged)
\begin{DoxyCompactList}\small\item\em Compute multi component source term\+: $ (\mathbf{U} \cdot \nabla T, \mathbf{U} \cdot \nabla S_l)$. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a41cba145f3ab41f8b3061dea005ea9c9}\label{class_a_m_r_level_mushy_layer_a41cba145f3ab41f8b3061dea005ea9c9}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a41cba145f3ab41f8b3061dea005ea9c9}{increment\+H\+C\+Flux\+Registers} (\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&flux, \textbf{ Real} flux\+Mult)
\begin{DoxyCompactList}\small\item\em Increment Enthalpy-\/\+Bulk concentration flux registers with flux. \end{DoxyCompactList}\item 
void \hyperlink{class_a_m_r_level_mushy_layer_a8f04027bc844bd17a8bed1e073978436}{compute\+Total\+Advective\+Fluxes} (\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&edge\+Scal\+Total)
\begin{DoxyCompactList}\small\item\em Compute total fluxes that provide the source term for implicit enthalpy-\/salinity updates. \end{DoxyCompactList}\item 
void \hyperlink{class_a_m_r_level_mushy_layer_a367dd316723860bb7bd1c8b97895a3f4}{advect\+Scalar} (const int a\+\_\+scalar\+Var, const int a\+\_\+advection\+Var, \textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+adv\+Vel, bool do\+F\+Rupdates=true)
\begin{DoxyCompactList}\small\item\em Update a scalar field by advection. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aec550a75ccdfb94eef6efb396228f075}\label{class_a_m_r_level_mushy_layer_aec550a75ccdfb94eef6efb396228f075}} 
void \hyperlink{class_a_m_r_level_mushy_layer_aec550a75ccdfb94eef6efb396228f075}{advect\+Scalar} (const int a\+\_\+scalar\+Var, const int a\+\_\+advection\+Var, \textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+adv\+Vel, bool do\+F\+Rupdates, \textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&flux)
\begin{DoxyCompactList}\small\item\em Update a scalar field with advective terms. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a0d28eb0d78389d0fc13f0b6c69b8157b}\label{class_a_m_r_level_mushy_layer_a0d28eb0d78389d0fc13f0b6c69b8157b}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a0d28eb0d78389d0fc13f0b6c69b8157b}{update\+Scalar\+Flux\+Register} (int a\+\_\+scalar\+Var, \textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&flux, \textbf{ Real} \textbf{ scale})
\begin{DoxyCompactList}\small\item\em Update flux register for scalar field. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_acfd7a12794a564615d7b507717ea0d70}\label{class_a_m_r_level_mushy_layer_acfd7a12794a564615d7b507717ea0d70}} 
void \hyperlink{class_a_m_r_level_mushy_layer_acfd7a12794a564615d7b507717ea0d70}{advect\+Lambda} (bool do\+F\+Rupdates=true)
\begin{DoxyCompactList}\small\item\em Advect lambda field (for freestream preservation) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a4c5ae9f4b8016a17944e103389ac6c1f}\label{class_a_m_r_level_mushy_layer_a4c5ae9f4b8016a17944e103389ac6c1f}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a4c5ae9f4b8016a17944e103389ac6c1f}{compute\+Advection\+Vel\+Source\+Term} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&advection\+Source\+Term)
\begin{DoxyCompactList}\small\item\em Make source term for the advection velocity solve. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a51a93e1db4963170b0cc831bf87bdbda}\label{class_a_m_r_level_mushy_layer_a51a93e1db4963170b0cc831bf87bdbda}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a51a93e1db4963170b0cc831bf87bdbda}{horizontally\+Average} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+averaged, \textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+phi)
\begin{DoxyCompactList}\small\item\em Average vertical fluxes in the horizontal direction. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a59d164085c308e534cdb44f558c56aed}\label{class_a_m_r_level_mushy_layer_a59d164085c308e534cdb44f558c56aed}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a59d164085c308e534cdb44f558c56aed}{horizontally\+Average} (\textbf{ Vector}$<$ \textbf{ Real} $>$ \&average\+Vector, \textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+phi)
\begin{DoxyCompactList}\small\item\em Average vertical fluxes in the horizontal direction. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ace588d01606542a417a8d2d05c80c392}\label{class_a_m_r_level_mushy_layer_ace588d01606542a417a8d2d05c80c392}} 
void \hyperlink{class_a_m_r_level_mushy_layer_ace588d01606542a417a8d2d05c80c392}{horizontally\+Average} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+averaged, \textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+phi, \textbf{ Vector}$<$ \textbf{ Real} $>$ \&average\+Vector)
\begin{DoxyCompactList}\small\item\em Average vertical fluxes in the horizontal direction. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a4467aac78f7a23f22a7d65d3441ffb8b}\label{class_a_m_r_level_mushy_layer_a4467aac78f7a23f22a7d65d3441ffb8b}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a4467aac78f7a23f22a7d65d3441ffb8b}{horizontally\+Average} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+averaged, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+phi)
\begin{DoxyCompactList}\small\item\em Average cell centred fields in the horizontal direction. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a56619b718d89610566ede8f9a6f74270}\label{class_a_m_r_level_mushy_layer_a56619b718d89610566ede8f9a6f74270}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a56619b718d89610566ede8f9a6f74270}{horizontally\+Average} (\textbf{ Vector}$<$ \textbf{ Real} $>$ \&average\+Vector, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+phi)
\begin{DoxyCompactList}\small\item\em Average cell centred fields in the horizontal direction. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_af2c7dbb0a17702772ed44fd557aff2ae}\label{class_a_m_r_level_mushy_layer_af2c7dbb0a17702772ed44fd557aff2ae}} 
void \hyperlink{class_a_m_r_level_mushy_layer_af2c7dbb0a17702772ed44fd557aff2ae}{horizontally\+Average} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+averaged, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+phi, \textbf{ Vector}$<$ \textbf{ Real} $>$ \&global\+Averaged)
\begin{DoxyCompactList}\small\item\em Average cell centred values in the horizontal direction. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ac6a447ff8d0a6f02f21434d01f89d6da}\label{class_a_m_r_level_mushy_layer_ac6a447ff8d0a6f02f21434d01f89d6da}} 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_ac6a447ff8d0a6f02f21434d01f89d6da}{average\+Over\+Liquid\+Region} (int a\+\_\+var)
\begin{DoxyCompactList}\small\item\em Compute average value of some scalar field over the liquid region of the domain. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_abee98266c434a0f7a88e034c0f297aa2}\label{class_a_m_r_level_mushy_layer_abee98266c434a0f7a88e034c0f297aa2}} 
void \hyperlink{class_a_m_r_level_mushy_layer_abee98266c434a0f7a88e034c0f297aa2}{compute\+Radiance\+Intensity} ()
\begin{DoxyCompactList}\small\item\em Compute the intensity of light from the surface at each point in the domain. \end{DoxyCompactList}\item 
void \hyperlink{class_a_m_r_level_mushy_layer_aff2c6df2ba8316ced0ae3aa476c676f4}{advect\+Passive\+Tracer} ()
\begin{DoxyCompactList}\small\item\em Advect a passive tracer $ \xi $. \end{DoxyCompactList}\item 
void \hyperlink{class_a_m_r_level_mushy_layer_a414498736c19f68d326f85cd10e33512}{compute\+Scalar\+Diffusive\+Src} (int a\+\_\+scalar\+Bulk\+Conc, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+src)
\begin{DoxyCompactList}\small\item\em Compute diffusive src for some scalar with bulk concentration $ \xi $. \end{DoxyCompactList}\item 
void \hyperlink{class_a_m_r_level_mushy_layer_a0b8cde0fa8d437f3fc9a21461945af7e}{compute\+Scalar\+Conc\+In\+Liquid} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&liquid\+\_\+tracer\+\_\+conc, int a\+\_\+tracer\+Var)
\begin{DoxyCompactList}\small\item\em Compute concentration of scalar (with bulk concentration $ \xi $ ) in the liquid phase. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a5791f0fe5bb9fefe4e1f551aad7e050e}\label{class_a_m_r_level_mushy_layer_a5791f0fe5bb9fefe4e1f551aad7e050e}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a5791f0fe5bb9fefe4e1f551aad7e050e}{advect\+Tracer} (int a\+\_\+tracer\+Var, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+src)
\begin{DoxyCompactList}\small\item\em Advect generic tracer. \end{DoxyCompactList}\item 
void \hyperlink{class_a_m_r_level_mushy_layer_ade318c50bdedb60ab371246da6895666}{advect\+Active\+Tracer} ()
\begin{DoxyCompactList}\small\item\em Advect active tracer $ \zeta $. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a1175d9df4f5acbc4de503d9cb253947e}\label{class_a_m_r_level_mushy_layer_a1175d9df4f5acbc4de503d9cb253947e}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a1175d9df4f5acbc4de503d9cb253947e}{compute\+Active\+Tracer\+Source\+Sink} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+src\+Sink)
\begin{DoxyCompactList}\small\item\em Compute sources/sinks for active tracer. \end{DoxyCompactList}\item 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_ab631de0d0116894c33286646a97eb395}{compute\+Mush\+Depth} (\textbf{ Real} a\+\_\+porosity\+\_\+criteria=0.\+99)
\begin{DoxyCompactList}\small\item\em Compute mushy layer depth. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a6741ef0d7091e2c65c4e4b9f9d5a172a}\label{class_a_m_r_level_mushy_layer_a6741ef0d7091e2c65c4e4b9f9d5a172a}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a6741ef0d7091e2c65c4e4b9f9d5a172a}{get\+Total\+Flux} (\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&total\+Flux)
\begin{DoxyCompactList}\small\item\em Calculate advective + diffusive flux. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a4a641297a46991e7aca4ab750b347a1f}\label{class_a_m_r_level_mushy_layer_a4a641297a46991e7aca4ab750b347a1f}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a4a641297a46991e7aca4ab750b347a1f}{compute\+Lap\+Vel} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+lap\+Vel, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+vel, const \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ $\ast$a\+\_\+crse\+Vel\+Ptr)
\begin{DoxyCompactList}\small\item\em Compute $ \nabla^2 \mathbf{U} $. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ae23a8e865baef2bc23d79e7839c2a31b}\label{class_a_m_r_level_mushy_layer_ae23a8e865baef2bc23d79e7839c2a31b}} 
void \hyperlink{class_a_m_r_level_mushy_layer_ae23a8e865baef2bc23d79e7839c2a31b}{compute\+Scal\+Diffusion} (const int a\+\_\+var, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+lap\+Scal, \textbf{ Real} a\+\_\+time)
\begin{DoxyCompactList}\small\item\em Compute $ \nabla^2 \phi $. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a00dc47be23a770c7a546a2b79a7bcf5c}\label{class_a_m_r_level_mushy_layer_a00dc47be23a770c7a546a2b79a7bcf5c}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a00dc47be23a770c7a546a2b79a7bcf5c}{compute\+Scal\+Diffusion} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&diffusive\+Src, \textbf{ Real} a\+\_\+time)
\begin{DoxyCompactList}\small\item\em Compute $ \nabla^2 (H, S) $. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a9af796bb0c94d60cb54d97c3c935bfdf}\label{class_a_m_r_level_mushy_layer_a9af796bb0c94d60cb54d97c3c935bfdf}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a9af796bb0c94d60cb54d97c3c935bfdf}{compute\+Scal\+Diffusion} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+src, int a\+\_\+var)
\begin{DoxyCompactList}\small\item\em Compute $ \nabla^2 \psi $ for some scalar field $ \psi $. \end{DoxyCompactList}\item 
void \hyperlink{class_a_m_r_level_mushy_layer_a2fd9b54613cbc9b22453ecf6986f2cf0}{compute\+C\+Cvelocity} (const \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&advection\+Source\+Term, \textbf{ Real} a\+\_\+old\+Time, \textbf{ Real} a\+\_\+dt, bool do\+F\+Rupdates=false, bool a\+\_\+do\+Projection=true, bool compute\+\_\+u\+DelU=true, bool a\+\_\+\+M\+A\+Cprojection=false)
\begin{DoxyCompactList}\small\item\em Compute new cell centred velocity. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_add600469accb563cfd9e5decab13db93}\label{class_a_m_r_level_mushy_layer_add600469accb563cfd9e5decab13db93}} 
bool \hyperlink{class_a_m_r_level_mushy_layer_add600469accb563cfd9e5decab13db93}{is\+Velocity\+Time\+Dependent} ()
\begin{DoxyCompactList}\small\item\em Is velocity time dependent? \end{DoxyCompactList}\item 
void \hyperlink{class_a_m_r_level_mushy_layer_ae4a68a07aa1a72f00379d30039bc8567}{compute\+Ustar} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+u\+Delu, const \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&advection\+Source\+Term, \textbf{ Real} a\+\_\+old\+Time, \textbf{ Real} a\+\_\+dt, bool do\+F\+Rupdates, bool a\+\_\+\+M\+A\+Cprojection=false, bool compute\+\_\+u\+DelU=true)
\begin{DoxyCompactList}\small\item\em Compute $ \mathbf{U}^* $, the velocity before we project it. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a3a3610299f885736d2ab2eee0d866bfc}\label{class_a_m_r_level_mushy_layer_a3a3610299f885736d2ab2eee0d866bfc}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a3a3610299f885736d2ab2eee0d866bfc}{compute\+Ustar\+Src} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&src, const \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&advection\+Source\+Term, \textbf{ Real} src\+\_\+time, bool a\+\_\+\+M\+A\+Cprojection=false, bool compute\+\_\+u\+DelU=true)
\begin{DoxyCompactList}\small\item\em Compute the source term for the $\mathbf{U}^* $ solve. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a5d389fbc5dae934d85f24d44545b33aa}\label{class_a_m_r_level_mushy_layer_a5d389fbc5dae934d85f24d44545b33aa}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a5d389fbc5dae934d85f24d44545b33aa}{compute\+U\+DelU} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&U\+\_\+adv\+\_\+src, const \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&advection\+Source\+Term, \textbf{ Real} a\+\_\+old\+Time, \textbf{ Real} a\+\_\+dt)
\begin{DoxyCompactList}\small\item\em Compute $ \mathbf{u} \cdot \nabla \left( \mathbf{U}/\chi \right) $. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a2eaf03458d4c0aa89dadf19ea122ca91}\label{class_a_m_r_level_mushy_layer_a2eaf03458d4c0aa89dadf19ea122ca91}} 
bool \hyperlink{class_a_m_r_level_mushy_layer_a2eaf03458d4c0aa89dadf19ea122ca91}{is\+Current\+C\+F\+L\+Safe} (bool print\+Warning=false)
\begin{DoxyCompactList}\small\item\em Check C\+FL based on latest velocity is safe to use for explicit updates. \end{DoxyCompactList}\item 
void \hyperlink{class_a_m_r_level_mushy_layer_acae45525ac3755ce260e5e3db2090f82}{add\+Heat\+Source} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&src)
\begin{DoxyCompactList}\small\item\em Add a fixed heat source. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a1699a841bc8d8371f55c6ac45152d4ea}\label{class_a_m_r_level_mushy_layer_a1699a841bc8d8371f55c6ac45152d4ea}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a1699a841bc8d8371f55c6ac45152d4ea}{set\+Vel\+Zero} (\textbf{ F\+Array\+Box} \&a\+\_\+vel, const \textbf{ F\+Array\+Box} \&a\+\_\+porosity, const \textbf{ Real} a\+\_\+limit, const int a\+\_\+radius=0)
\begin{DoxyCompactList}\small\item\em Set velocity to zero where porosity is sufficiently small (\textbf{ F\+Array\+Box} version) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ad1e22532941e086464363b556c60b82c}\label{class_a_m_r_level_mushy_layer_ad1e22532941e086464363b556c60b82c}} 
void \hyperlink{class_a_m_r_level_mushy_layer_ad1e22532941e086464363b556c60b82c}{compute\+GradP} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&gradP, \textbf{ Real} a\+\_\+time, bool a\+\_\+mac\+Projection=false)
\begin{DoxyCompactList}\small\item\em Returns $ \nabla P $ at the specified time. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a1da14630642f32edf8ab0c3d27ecf60e}\label{class_a_m_r_level_mushy_layer_a1da14630642f32edf8ab0c3d27ecf60e}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a1da14630642f32edf8ab0c3d27ecf60e}{trace\+Advection\+Vel} (\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+adv\+Vel, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+old\+\_\+vel, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&U\+\_\+chi, const \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+viscous\+Source, \textbf{ Patch\+Godunov} \&a\+\_\+patch\+God\+Velocity, \textbf{ Real} a\+\_\+old\+\_\+time, \textbf{ Real} a\+\_\+dt)
\begin{DoxyCompactList}\small\item\em Trace the advection velocity forward in time. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a2ed1d9901a378d3440132707239df044}\label{class_a_m_r_level_mushy_layer_a2ed1d9901a378d3440132707239df044}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a2ed1d9901a378d3440132707239df044}{compute\+Predicted\+Velocities} (\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&U\+\_\+chi\+\_\+new, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+trace\+Vel, \textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+adv\+Vel, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&U\+\_\+chi, const \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+viscous\+Source, \textbf{ Patch\+Godunov} \&a\+\_\+patch\+God\+Velocity, \textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+grad\+\_\+e\+Lambda, \textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+grad\+Phi, \textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&porosity\+Face, \textbf{ Real} a\+\_\+old\+\_\+time, \textbf{ Real} a\+\_\+dt)
\begin{DoxyCompactList}\small\item\em Compute advection velocities at the half time step. \end{DoxyCompactList}\item 
void \hyperlink{class_a_m_r_level_mushy_layer_a77914a8f6be67642c366b4da8e0a2829}{compute\+Scalar\+Advective\+Flux} (\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+edge\+Scal, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+old\+\_\+scal, \textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+adv\+\_\+vel, \textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+inflow\+Outflow\+Vel, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+old\+\_\+vel, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+diffusive\+Src, \textbf{ Patch\+Godunov} \&a\+\_\+patch\+God, \textbf{ Real} a\+\_\+old\+\_\+time, \textbf{ Real} a\+\_\+dt)
\begin{DoxyCompactList}\small\item\em Compute the advective flux given the scalar field, advection velocity and source term specified. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a6d02158d0d0bc38c7d7841f526b6a5f8}\label{class_a_m_r_level_mushy_layer_a6d02158d0d0bc38c7d7841f526b6a5f8}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a6d02158d0d0bc38c7d7841f526b6a5f8}{upwind} (\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+edge\+Scal, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+old\+\_\+scal, \textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+adv\+\_\+vel, \textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+inflow\+Outflow\+Vel, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+old\+\_\+vel, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+diffusive\+Src, \textbf{ Patch\+Godunov} \&a\+\_\+patch\+God, \textbf{ Real} a\+\_\+old\+\_\+time, \textbf{ Real} a\+\_\+dt)
\begin{DoxyCompactList}\small\item\em Refactored this so we can also use for velocities if we want. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aea6e1dcc346f61095f39876616eb0133}\label{class_a_m_r_level_mushy_layer_aea6e1dcc346f61095f39876616eb0133}} 
void \hyperlink{class_a_m_r_level_mushy_layer_aea6e1dcc346f61095f39876616eb0133}{compute\+Scalar\+Advective\+Flux} (\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+edge\+Scal, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+scalar\+\_\+advection\+\_\+old, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+src, \textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+adv\+Vel, int a\+\_\+advection\+Var, \textbf{ Real} a\+\_\+old\+\_\+time, \textbf{ Real} a\+\_\+dt)
\begin{DoxyCompactList}\small\item\em Compute advective flux. \end{DoxyCompactList}\item 
void \hyperlink{class_a_m_r_level_mushy_layer_af3fc0d2c619ba6ad099b1ad6c39b352e}{compute\+Scalar\+Advective\+Flux} (\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+edge\+Scal, int a\+\_\+advection\+Var, int a\+\_\+diffusion\+Var, \textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+adv\+Vel, \textbf{ Real} a\+\_\+old\+\_\+time, \textbf{ Real} a\+\_\+dt)
\begin{DoxyCompactList}\small\item\em Compute the advective flux. \end{DoxyCompactList}\item 
void \hyperlink{class_a_m_r_level_mushy_layer_a496393891a2db8a73b2f398f90324af5}{compute\+Scalar\+Advective\+Flux\+Multi\+Comp} (\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+edge\+Scal, \textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+adv\+Vel, \textbf{ Patch\+Godunov} \&a\+\_\+patch\+God, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+scal\+Old, \textbf{ Real} a\+\_\+old\+\_\+time, \textbf{ Real} a\+\_\+dt)
\begin{DoxyCompactList}\small\item\em Compute the advective flux for the enthalpy and salinity equations,. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a3342f199c61922a84dbfd2187ece6d39}\label{class_a_m_r_level_mushy_layer_a3342f199c61922a84dbfd2187ece6d39}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a3342f199c61922a84dbfd2187ece6d39}{predict\+Velocities} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+u\+DelU, \textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+adv\+Vel, const \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+src, \textbf{ Real} old\+\_\+time, \textbf{ Real} a\+\_\+dt, bool do\+F\+Rupdates)
\begin{DoxyCompactList}\small\item\em Calculate $ \mathbf{u} \cdot \nabla \left( \mathbf{u}/\chi \right) $. \end{DoxyCompactList}\item 
void \hyperlink{class_a_m_r_level_mushy_layer_a0169d83decd5824058e36a4b126f762a}{calculate\+Time\+Ind\+Advection\+Vel} (\textbf{ Real} a\+\_\+time, \textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+adv\+Vel)
\begin{DoxyCompactList}\small\item\em Calculate advection velocity for momentum equations which are time independent. \end{DoxyCompactList}\item 
void \hyperlink{class_a_m_r_level_mushy_layer_a67558aa3b7d4e0e04f06c44b54f8ab1e}{fill\+Unprojected\+Darcy\+Velocity} (\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+adv\+Vel, \textbf{ Real} \textbf{ time})
\begin{DoxyCompactList}\small\item\em Fill unprojected darcy velocity. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a6bfa0df4b16a33c034f01b49f51a5ffe}\label{class_a_m_r_level_mushy_layer_a6bfa0df4b16a33c034f01b49f51a5ffe}} 
int \hyperlink{class_a_m_r_level_mushy_layer_a6bfa0df4b16a33c034f01b49f51a5ffe}{get\+Max\+Level} ()
\begin{DoxyCompactList}\small\item\em Get maximum level allowed in \textbf{ A\+MR} hierarchy. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a5540e3771739fbb478808feaffc26cc4}\label{class_a_m_r_level_mushy_layer_a5540e3771739fbb478808feaffc26cc4}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a5540e3771739fbb478808feaffc26cc4}{compute\+Viscosity} ()
\begin{DoxyCompactList}\small\item\em Compute the viscosity given the current liquid concentration. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ac2c8316afa057d4697ed7f7a5b8435b2}\label{class_a_m_r_level_mushy_layer_ac2c8316afa057d4697ed7f7a5b8435b2}} 
void \hyperlink{class_a_m_r_level_mushy_layer_ac2c8316afa057d4697ed7f7a5b8435b2}{fill\+Adv\+Vel} (\textbf{ Real} \textbf{ time}, \textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+adv\+Vel)
\begin{DoxyCompactList}\small\item\em Fill advection velocity ghost cells. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a12544df6a861f6b25411c1bb88247622}\label{class_a_m_r_level_mushy_layer_a12544df6a861f6b25411c1bb88247622}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a12544df6a861f6b25411c1bb88247622}{fill\+Analytic\+Vel} (\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+adv\+Vel)
\begin{DoxyCompactList}\small\item\em Fill the velocity with some analytically determined function. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aa31ea2f84b91e961b747c4cc471482f6}\label{class_a_m_r_level_mushy_layer_aa31ea2f84b91e961b747c4cc471482f6}} 
void \hyperlink{class_a_m_r_level_mushy_layer_aa31ea2f84b91e961b747c4cc471482f6}{fill\+Analytic\+Vel} (\textbf{ F\+Array\+Box} \&vel\+Dir, int dir, int comp, bool project)
\begin{DoxyCompactList}\small\item\em Fill the velocity with some analytically determined function. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a9ec0b80e9c4c2fb7eca849a4cb37b540}\label{class_a_m_r_level_mushy_layer_a9ec0b80e9c4c2fb7eca849a4cb37b540}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a9ec0b80e9c4c2fb7eca849a4cb37b540}{fill\+Analytic\+Vel} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&vel\+Dir)
\begin{DoxyCompactList}\small\item\em Fill the velocity with some analytically determined function. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aa6503b22c51b51c10ce48907d7a97960}\label{class_a_m_r_level_mushy_layer_aa6503b22c51b51c10ce48907d7a97960}} 
void \hyperlink{class_a_m_r_level_mushy_layer_aa6503b22c51b51c10ce48907d7a97960}{fill\+Buoyancy} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+buoyancy, \textbf{ Real} a\+\_\+time)
\begin{DoxyCompactList}\small\item\em Compute the buoyancy force. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_af42680f8ea7ca8a032d99316025c4430}\label{class_a_m_r_level_mushy_layer_af42680f8ea7ca8a032d99316025c4430}} 
void \hyperlink{class_a_m_r_level_mushy_layer_af42680f8ea7ca8a032d99316025c4430}{fill\+Buoyancy} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+buoyancy, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+temperature, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+liquid\+Conc, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+porosity)
\begin{DoxyCompactList}\small\item\em Compute the buoyancy force. \end{DoxyCompactList}\item 
void \hyperlink{class_a_m_r_level_mushy_layer_a33522b27aabe2763e57c66c2ab4e2e09}{fill\+Buoyancy} (\textbf{ F\+Array\+Box} \&buoyancy, \textbf{ F\+Array\+Box} \&temperature, \textbf{ F\+Array\+Box} \&liquid\+Conc, \textbf{ F\+Array\+Box} \&porosity, \textbf{ F\+Array\+Box} \&body\+Force)
\begin{DoxyCompactList}\small\item\em Compute the buoyancy force. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aa0608e87885807b1f06317aa1225a34e}\label{class_a_m_r_level_mushy_layer_aa0608e87885807b1f06317aa1225a34e}} 
void \hyperlink{class_a_m_r_level_mushy_layer_aa0608e87885807b1f06317aa1225a34e}{fill\+Pressure\+Src\+Term} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&gradP, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&pressure\+Scale, \textbf{ Real} a\+\_\+time, bool a\+\_\+\+M\+A\+Cprojection)
\begin{DoxyCompactList}\small\item\em Compute $ \nabla P $ at time $ t $. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_af84d4bfd20b485943ea1f02f3772d4f1}\label{class_a_m_r_level_mushy_layer_af84d4bfd20b485943ea1f02f3772d4f1}} 
void \hyperlink{class_a_m_r_level_mushy_layer_af84d4bfd20b485943ea1f02f3772d4f1}{fill\+A\+M\+R\+Vel\+Porosity} (\textbf{ Vector}$<$ \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ $\ast$$>$ \&amr\+Vel, \textbf{ Vector}$<$ \textbf{ Ref\+Counted\+Ptr}$<$ \textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ $>$ $>$ \&amr\+Porosity\+Face, \textbf{ Vector}$<$ \textbf{ Ref\+Counted\+Ptr}$<$ \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ $>$ $>$ \&amr\+Porosity)
\begin{DoxyCompactList}\small\item\em Compile velocity and porosity across an \textbf{ A\+MR} hierarchy. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aeb42507e6f3613a4ea88070e858b0f48}\label{class_a_m_r_level_mushy_layer_aeb42507e6f3613a4ea88070e858b0f48}} 
void \hyperlink{class_a_m_r_level_mushy_layer_aeb42507e6f3613a4ea88070e858b0f48}{fill\+HC} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+phi, \textbf{ Real} a\+\_\+time, bool do\+Interior=true, bool quad\+Interp=true)
\begin{DoxyCompactList}\small\item\em Should include correct exchange calls. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a870c44d49909c5c650ea96bc09bff69e}\label{class_a_m_r_level_mushy_layer_a870c44d49909c5c650ea96bc09bff69e}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a870c44d49909c5c650ea96bc09bff69e}{fill\+Fixed\+Porosity} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+porosity)
\begin{DoxyCompactList}\small\item\em Fill porosity with some fixed value if appropriate. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a2b9e24e70db3c56fbf196b0a75dc4640}\label{class_a_m_r_level_mushy_layer_a2b9e24e70db3c56fbf196b0a75dc4640}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a2b9e24e70db3c56fbf196b0a75dc4640}{fill\+T\+Cl} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+phi, \textbf{ Real} a\+\_\+time, bool do\+Interior=true, bool quad\+Interp=true)
\begin{DoxyCompactList}\small\item\em Should include correct exchange calls. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aa47f13f40861dc812b16e8bb2ba607db}\label{class_a_m_r_level_mushy_layer_aa47f13f40861dc812b16e8bb2ba607db}} 
void \hyperlink{class_a_m_r_level_mushy_layer_aa47f13f40861dc812b16e8bb2ba607db}{fill\+Multi\+Comp} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+phi, \textbf{ Real} a\+\_\+time, int scal1, int scal2, bool do\+Interior=true, bool quad\+Interp=true, bool apply\+\_\+bcs=true)
\begin{DoxyCompactList}\small\item\em Should include correct exchange calls. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a3bd5a285797a695854292545b8342c75}\label{class_a_m_r_level_mushy_layer_a3bd5a285797a695854292545b8342c75}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a3bd5a285797a695854292545b8342c75}{fill\+A\+M\+R\+Lambda} (\textbf{ Vector}$<$ \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ $\ast$$>$ \&amr\+Lambda)
\begin{DoxyCompactList}\small\item\em Compile $ \lambda $ across the entire \textbf{ A\+MR} hierarchy. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a7aef043fd3a6055c2240b297c0c62de1}\label{class_a_m_r_level_mushy_layer_a7aef043fd3a6055c2240b297c0c62de1}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a7aef043fd3a6055c2240b297c0c62de1}{calculate\+Analytic\+Solns} (bool enforce\+Solutions=true)
\begin{DoxyCompactList}\small\item\em Calculate analytic solution to this problem (if possible) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a649d148960a286ead48d991f696ef945}\label{class_a_m_r_level_mushy_layer_a649d148960a286ead48d991f696ef945}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a649d148960a286ead48d991f696ef945}{set\+Porosity} (\textbf{ F\+Array\+Box} \&a\+\_\+porosity)
\begin{DoxyCompactList}\small\item\em Set fixed porosity. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aec845e1d2322bb91f229e21fe9131362}\label{class_a_m_r_level_mushy_layer_aec845e1d2322bb91f229e21fe9131362}} 
void \hyperlink{class_a_m_r_level_mushy_layer_aec845e1d2322bb91f229e21fe9131362}{fill\+Frame\+Velocity} ()
\begin{DoxyCompactList}\small\item\em Fill frame advection velocity. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a78e4a88f5513ac4af2b60516f429d148}\label{class_a_m_r_level_mushy_layer_a78e4a88f5513ac4af2b60516f429d148}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a78e4a88f5513ac4af2b60516f429d148}{add\+Perturbation} (int a\+\_\+var, \textbf{ Real} alpha, int wave\+Number=-\/1, \textbf{ Real} phase\+Shift=0)
\begin{DoxyCompactList}\small\item\em Add a small perturbation to the solution. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a7b7760d193911a689cb815b254fd5e5e}\label{class_a_m_r_level_mushy_layer_a7b7760d193911a689cb815b254fd5e5e}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a7b7760d193911a689cb815b254fd5e5e}{add\+Melt\+Pond} ()
\begin{DoxyCompactList}\small\item\em Add a melt pond if we want. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a042642fed8f9a314bc7b42a8c2766f0d}\label{class_a_m_r_level_mushy_layer_a042642fed8f9a314bc7b42a8c2766f0d}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a042642fed8f9a314bc7b42a8c2766f0d}{define\+Ustar\+Solver} (\textbf{ Vector}$<$ \textbf{ Ref\+Counted\+Ptr}$<$ \textbf{ Level\+Backward\+Euler} $>$ $>$ \&a\+\_\+\+Ustar\+BE, \textbf{ Vector}$<$ \textbf{ Ref\+Counted\+Ptr}$<$ \textbf{ Level\+T\+GA} $>$ $>$ \&a\+\_\+\+Ustar\+T\+GA)
\begin{DoxyCompactList}\small\item\em Define implicit solver for $ \mathbf{u}^* $ including timestepping. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_adc8d468e5e11a60cf8dd23a8d5c2772d}\label{class_a_m_r_level_mushy_layer_adc8d468e5e11a60cf8dd23a8d5c2772d}} 
void \hyperlink{class_a_m_r_level_mushy_layer_adc8d468e5e11a60cf8dd23a8d5c2772d}{define\+Ustar\+Multigrid} ()
\begin{DoxyCompactList}\small\item\em Define multigrid solver for $ \mathbf{u}^* $. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a0f1af6cfb8e2c45d129ad1915ede5dde}\label{class_a_m_r_level_mushy_layer_a0f1af6cfb8e2c45d129ad1915ede5dde}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a0f1af6cfb8e2c45d129ad1915ede5dde}{initialize\+Level\+Pressure} (\textbf{ Real} a\+\_\+current\+Time, \textbf{ Real} a\+\_\+dt\+Init)
\begin{DoxyCompactList}\small\item\em Initialize pressure on this level. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a1f0fe62753524750fe9b697cfef36f7f}\label{class_a_m_r_level_mushy_layer_a1f0fe62753524750fe9b697cfef36f7f}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a1f0fe62753524750fe9b697cfef36f7f}{initialize\+Global\+Pressure} (\textbf{ Real} dt\+Init=-\/1, bool init=true)
\begin{DoxyCompactList}\small\item\em Initialize pressure across all levels. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ab47973fd99a94257b3221d1be16b1bf1}\label{class_a_m_r_level_mushy_layer_ab47973fd99a94257b3221d1be16b1bf1}} 
void \hyperlink{class_a_m_r_level_mushy_layer_ab47973fd99a94257b3221d1be16b1bf1}{compute\+Init\+Advection\+Vel} ()
\begin{DoxyCompactList}\small\item\em Compute initial advection velocities. \end{DoxyCompactList}\item 
void \hyperlink{class_a_m_r_level_mushy_layer_abc11317ec5dd18433dc83b3ab2aaf959}{init\+Time\+Independent\+Pressure} (\hyperlink{class_a_m_r_level_mushy_layer}{A\+M\+R\+Level\+Mushy\+Layer} $\ast$lev, int a\+\_\+max\+\_\+num\+\_\+iter=-\/1)
\begin{DoxyCompactList}\small\item\em Initialise phi (pressure for Darcy equation) \end{DoxyCompactList}\item 
void \hyperlink{class_a_m_r_level_mushy_layer_a28479bc8ab69c855a8d79628cddd5b28}{reset\+Lambda} ()
\begin{DoxyCompactList}\small\item\em Flag if a new level has been added. \end{DoxyCompactList}\item 
void \hyperlink{class_a_m_r_level_mushy_layer_a57a9b87c77a7e0aa8b9082dc1a20959d}{A\+M\+R\+Reflux\+Lambda} ()
\begin{DoxyCompactList}\small\item\em Reflux $ \lambda $ across \textbf{ A\+MR} hierarchy. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a9ea8d57926a8281f053c6277f5b39291}\label{class_a_m_r_level_mushy_layer_a9ea8d57926a8281f053c6277f5b39291}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a9ea8d57926a8281f053c6277f5b39291}{define\+Regrid\+A\+M\+R\+Op} (\textbf{ A\+M\+R\+Poisson\+Op\+Factory} \&a\+\_\+factory, const \textbf{ Vector}$<$ \textbf{ Disjoint\+Box\+Layout} $>$ \&a\+\_\+grids, const \textbf{ Vector}$<$ \textbf{ Problem\+Domain} $>$ \&a\+\_\+domains, const \textbf{ Vector}$<$ \textbf{ Real} $>$ \&a\+\_\+amr\+Dx, const \textbf{ Vector}$<$ int $>$ \&a\+\_\+ref\+Ratios, const int \&a\+\_\+l\+Base)
\begin{DoxyCompactList}\small\item\em Define operator for post regrid smoothing. \end{DoxyCompactList}\item 
void \hyperlink{class_a_m_r_level_mushy_layer_a0e1a5d490de9799a0579aa3bcc35a021}{get\+Coarse\+Scalar\+Data\+Pointers} (const int a\+\_\+scalar\+Var, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ $\ast$$\ast$a\+\_\+coarser\+Data\+Old\+Ptr, \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ $\ast$$\ast$a\+\_\+coarser\+Data\+New\+Ptr, \textbf{ Level\+Flux\+Register} $\ast$$\ast$a\+\_\+coarser\+F\+R\+Ptr, \textbf{ Level\+Flux\+Register} $\ast$$\ast$a\+\_\+finer\+F\+R\+Ptr, \textbf{ Real} \&a\+\_\+t\+Coarser\+Old, \textbf{ Real} \&a\+\_\+t\+Coarser\+New)
\begin{DoxyCompactList}\small\item\em Smooth the velocity field. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_af9d9ba5a4bed0091b9e5ecd4d84cd12d}\label{class_a_m_r_level_mushy_layer_af9d9ba5a4bed0091b9e5ecd4d84cd12d}} 
void \hyperlink{class_a_m_r_level_mushy_layer_af9d9ba5a4bed0091b9e5ecd4d84cd12d}{fill\+Vector\+Field} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+vector, \textbf{ Real} a\+\_\+time, int a\+\_\+var, bool do\+Interior=false, bool quad\+Interp=false)
\begin{DoxyCompactList}\small\item\em Doesn\textquotesingle{}t do any time interpolation -\/ just fills ghost cells if necessary. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ac4febc305a0d315b3942ac4dfd42d569}\label{class_a_m_r_level_mushy_layer_ac4febc305a0d315b3942ac4dfd42d569}} 
void \hyperlink{class_a_m_r_level_mushy_layer_ac4febc305a0d315b3942ac4dfd42d569}{fill\+Scalars} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+scal, \textbf{ Real} a\+\_\+time, const int a\+\_\+var, bool do\+Interior=false, bool quad\+Interp=false, int a\+\_\+comp=0, bool apply\+\_\+bcs=true)
\begin{DoxyCompactList}\small\item\em Fill ghost cells of scalar field. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a0d83bb04c2d1d070bfaf5ee68d9fbb8e}\label{class_a_m_r_level_mushy_layer_a0d83bb04c2d1d070bfaf5ee68d9fbb8e}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a0d83bb04c2d1d070bfaf5ee68d9fbb8e}{fill\+Buoyancy} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+buoyancy, \textbf{ Real} a\+\_\+time, bool quad\+Interp)
\begin{DoxyCompactList}\small\item\em Helper function. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a1b8c487cd378d7aa409a59ecc18a1e66}\label{class_a_m_r_level_mushy_layer_a1b8c487cd378d7aa409a59ecc18a1e66}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a1b8c487cd378d7aa409a59ecc18a1e66}{fill\+Scalar\+Face} (\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+scal, \textbf{ Real} a\+\_\+time, const int a\+\_\+var, bool do\+Interior=false, bool quad\+Interp=false)
\begin{DoxyCompactList}\small\item\em Fill ghost cells of scalar field (edge-\/centred) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a20fcbe7201a07b0e90405b45f806ffc7}\label{class_a_m_r_level_mushy_layer_a20fcbe7201a07b0e90405b45f806ffc7}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a20fcbe7201a07b0e90405b45f806ffc7}{fill\+Scalar\+Face} (\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+scal, \textbf{ Real} a\+\_\+time, const int a\+\_\+var, Cell\+To\+Edge\+Averaging\+Method method, bool do\+Interior=false, bool quad\+Interp=false, \textbf{ Real} smoothing=0.\+0)
\begin{DoxyCompactList}\small\item\em Fill ghost cells of scalar field (edge-\/centred) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a64193ef3a3eba669336ec93b6dde857f}\label{class_a_m_r_level_mushy_layer_a64193ef3a3eba669336ec93b6dde857f}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a64193ef3a3eba669336ec93b6dde857f}{get\+Scalar\+B\+Cs} (\textbf{ B\+C\+Holder} \&this\+BC, int a\+\_\+var, bool a\+\_\+homogeneous)
\begin{DoxyCompactList}\small\item\em Get boundary conditions for implicit problems. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ac533661ed4f32a562f30e7489bbb384f}\label{class_a_m_r_level_mushy_layer_ac533661ed4f32a562f30e7489bbb384f}} 
void \hyperlink{class_a_m_r_level_mushy_layer_ac533661ed4f32a562f30e7489bbb384f}{compute\+Inflow\+Outflow\+Adv\+Vel} ()
\begin{DoxyCompactList}\small\item\em Refactored this to be consistent. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a50b7408c664ba80543611da02f5d6900}\label{class_a_m_r_level_mushy_layer_a50b7408c664ba80543611da02f5d6900}} 
\textbf{ Phys\+I\+BC} $\ast$ \hyperlink{class_a_m_r_level_mushy_layer_a50b7408c664ba80543611da02f5d6900}{get\+Scalar\+I\+B\+Cs} (int a\+\_\+var)
\begin{DoxyCompactList}\small\item\em Get initial and boundary conditions for advection. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a21d31ff0ea4de68bf77d0439712d2257}\label{class_a_m_r_level_mushy_layer_a21d31ff0ea4de68bf77d0439712d2257}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a21d31ff0ea4de68bf77d0439712d2257}{convert\+B\+C\+Type} (const int a\+\_\+implicit\+BC, const \textbf{ Real} a\+\_\+implicit\+Val, int \&a\+\_\+explicit\+BC, \textbf{ Real} a\+\_\+explicit\+Val)
\begin{DoxyCompactList}\small\item\em Need to convert implicit dirichlet/neuman/inflow outflow B\+Cs to advection B\+Cs. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aae8bd0481accd53b1662d44ddf27eb33}\label{class_a_m_r_level_mushy_layer_aae8bd0481accd53b1662d44ddf27eb33}} 
int \hyperlink{class_a_m_r_level_mushy_layer_aae8bd0481accd53b1662d44ddf27eb33}{convert\+B\+C\+Type} (const int a\+\_\+implicit\+BC)
\begin{DoxyCompactList}\small\item\em Convert implicit B\+Cs. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a38a4a2391d1667f06f8f003afb3dba12}\label{class_a_m_r_level_mushy_layer_a38a4a2391d1667f06f8f003afb3dba12}} 
bool \hyperlink{class_a_m_r_level_mushy_layer_a38a4a2391d1667f06f8f003afb3dba12}{crashed} ()
\begin{DoxyCompactList}\small\item\em Check the simulation hasn\textquotesingle{}t crashed. \end{DoxyCompactList}\item 
void \hyperlink{class_a_m_r_level_mushy_layer_a906ecc9974f8cfee4d6709e12c150a3e}{do\+Regularisation\+Ops} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&a\+\_\+scal, int a\+\_\+var, int a\+\_\+comp=0)
\begin{DoxyCompactList}\small\item\em Operations to keep variables bounded correctly. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a73762651a7132b0781462f76ce51ec59}\label{class_a_m_r_level_mushy_layer_a73762651a7132b0781462f76ce51ec59}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a73762651a7132b0781462f76ce51ec59}{do\+Regularisation\+Ops} (\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+scal, int a\+\_\+var, int a\+\_\+comp=0)
\begin{DoxyCompactList}\small\item\em Operations to keep variables bounded correctly. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_afb463c708318f9aadac6849ae858d534}\label{class_a_m_r_level_mushy_layer_afb463c708318f9aadac6849ae858d534}} 
void \hyperlink{class_a_m_r_level_mushy_layer_afb463c708318f9aadac6849ae858d534}{do\+Regularisation\+Ops} (int a\+\_\+var, \textbf{ F\+Array\+Box} \&a\+\_\+state, int a\+\_\+comp=0)
\begin{DoxyCompactList}\small\item\em Operations to keep variables bounded correctly. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a40d0ffb6722e302d733c369ae44e9de4}\label{class_a_m_r_level_mushy_layer_a40d0ffb6722e302d733c369ae44e9de4}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a40d0ffb6722e302d733c369ae44e9de4}{do\+Regularisation\+Ops\+New} (int a\+\_\+var, \textbf{ F\+Array\+Box} \&a\+\_\+state, int a\+\_\+comp=0)
\begin{DoxyCompactList}\small\item\em New version of \hyperlink{class_a_m_r_level_mushy_layer_a906ecc9974f8cfee4d6709e12c150a3e}{do\+Regularisation\+Ops()} which uses fortran routines. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ae7241de9407e8d6a7ad84166d5cc24fc}\label{class_a_m_r_level_mushy_layer_ae7241de9407e8d6a7ad84166d5cc24fc}} 
void \hyperlink{class_a_m_r_level_mushy_layer_ae7241de9407e8d6a7ad84166d5cc24fc}{set\+Flux\+Registers\+Zero} ()
\begin{DoxyCompactList}\small\item\em Reset all flux registers. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ad0fbde13c159047cbc2cfd3e3eb83eb0}\label{class_a_m_r_level_mushy_layer_ad0fbde13c159047cbc2cfd3e3eb83eb0}} 
void \hyperlink{class_a_m_r_level_mushy_layer_ad0fbde13c159047cbc2cfd3e3eb83eb0}{copy\+New\+To\+Old\+States} ()
\begin{DoxyCompactList}\small\item\em Copy new data to old data holders. \end{DoxyCompactList}\item 
bool \hyperlink{class_a_m_r_level_mushy_layer_a75b13a9a6c8b2f6db2e1268e760ca9f9}{do\+Velocity\+Advection} ()
\begin{DoxyCompactList}\small\item\em Do we need to do velocity advection? \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a6eb2873a405edcb7f9ae01f6ba28fe44}\label{class_a_m_r_level_mushy_layer_a6eb2873a405edcb7f9ae01f6ba28fe44}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a6eb2873a405edcb7f9ae01f6ba28fe44}{compute\+Advection\+Velocities} (\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&advection\+Src, \textbf{ Real} adv\+Vel\+Centering=0.\+5)
\begin{DoxyCompactList}\small\item\em Compute advection velocity. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_adbe81ed4dc8e5b76516390d359df16f7}\label{class_a_m_r_level_mushy_layer_adbe81ed4dc8e5b76516390d359df16f7}} 
void \hyperlink{class_a_m_r_level_mushy_layer_adbe81ed4dc8e5b76516390d359df16f7}{correct\+Edge\+Centred\+Velocity} (\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&a\+\_\+adv\+Vel, \textbf{ Real} a\+\_\+dt)
\begin{DoxyCompactList}\small\item\em Correct velocity (projection + volume discrepancy) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aa6359d3a5c627812a89197d5ccb0a597}\label{class_a_m_r_level_mushy_layer_aa6359d3a5c627812a89197d5ccb0a597}} 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_aa6359d3a5c627812a89197d5ccb0a597}{compute\+Dt\+Init} (int finest\+\_\+level)
\begin{DoxyCompactList}\small\item\em Compute initial $ \Delta t $. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ac6e420d455e8086d3f996042d59679c5}\label{class_a_m_r_level_mushy_layer_ac6e420d455e8086d3f996042d59679c5}} 
\hyperlink{class_a_m_r_level_mushy_layer}{A\+M\+R\+Level\+Mushy\+Layer} $\ast$ \hyperlink{class_a_m_r_level_mushy_layer_ac6e420d455e8086d3f996042d59679c5}{get\+Coarser\+Level} () const
\begin{DoxyCompactList}\small\item\em Get the next coarser level. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a077bec843072abfd8ed2a23dfee10d56}\label{class_a_m_r_level_mushy_layer_a077bec843072abfd8ed2a23dfee10d56}} 
\hyperlink{class_a_m_r_level_mushy_layer}{A\+M\+R\+Level\+Mushy\+Layer} $\ast$ \hyperlink{class_a_m_r_level_mushy_layer_a077bec843072abfd8ed2a23dfee10d56}{get\+Coarsest\+Level} ()
\begin{DoxyCompactList}\small\item\em Get the coarsest level. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a4cc18867fd36ba0e95544b671b244b49}\label{class_a_m_r_level_mushy_layer_a4cc18867fd36ba0e95544b671b244b49}} 
\hyperlink{class_a_m_r_level_mushy_layer}{A\+M\+R\+Level\+Mushy\+Layer} $\ast$ \hyperlink{class_a_m_r_level_mushy_layer_a4cc18867fd36ba0e95544b671b244b49}{get\+Finer\+Level} () const
\begin{DoxyCompactList}\small\item\em Get the next finer level. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aa8b1365bdf67cc5b82bec6c04a25f6a0}\label{class_a_m_r_level_mushy_layer_aa8b1365bdf67cc5b82bec6c04a25f6a0}} 
void \hyperlink{class_a_m_r_level_mushy_layer_aa8b1365bdf67cc5b82bec6c04a25f6a0}{set\+Advection\+B\+Cs} ()
\begin{DoxyCompactList}\small\item\em Set B\+Cs on advection physics classes. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a37fc9d2aa2b584dc78babfc99cacc4ca}\label{class_a_m_r_level_mushy_layer_a37fc9d2aa2b584dc78babfc99cacc4ca}} 
void \hyperlink{class_a_m_r_level_mushy_layer_a37fc9d2aa2b584dc78babfc99cacc4ca}{define\+I\+B\+Cs} ()
\begin{DoxyCompactList}\small\item\em Define initial and boundary conditions for advection problems. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a1ee4e1a2fc0863bca7550be4e3dcc6c4}\label{class_a_m_r_level_mushy_layer_a1ee4e1a2fc0863bca7550be4e3dcc6c4}} 
\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \hyperlink{class_a_m_r_level_mushy_layer_a1ee4e1a2fc0863bca7550be4e3dcc6c4}{m\+\_\+adv\+Vel}
\begin{DoxyCompactList}\small\item\em Advection velocity. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_af8641fd347befbe1d1d1779102d08f74}\label{class_a_m_r_level_mushy_layer_af8641fd347befbe1d1d1779102d08f74}} 
\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \hyperlink{class_a_m_r_level_mushy_layer_af8641fd347befbe1d1d1779102d08f74}{m\+\_\+adv\+Vel\+Old}
\begin{DoxyCompactList}\small\item\em Advection velocity at old time. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a348a74b9d75e95c79ea6a0edd050ab7f}\label{class_a_m_r_level_mushy_layer_a348a74b9d75e95c79ea6a0edd050ab7f}} 
\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \hyperlink{class_a_m_r_level_mushy_layer_a348a74b9d75e95c79ea6a0edd050ab7f}{m\+\_\+adv\+Vel\+New}
\begin{DoxyCompactList}\small\item\em Advection velocity at new time. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a6faf8aa52dbd4627dce4a2408bac25e7}\label{class_a_m_r_level_mushy_layer_a6faf8aa52dbd4627dce4a2408bac25e7}} 
\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \hyperlink{class_a_m_r_level_mushy_layer_a6faf8aa52dbd4627dce4a2408bac25e7}{m\+\_\+frame\+Adv\+Vel}
\begin{DoxyCompactList}\small\item\em Frame advection velocity. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a6bba1599c6385bfc52087d65d83e2485}\label{class_a_m_r_level_mushy_layer_a6bba1599c6385bfc52087d65d83e2485}} 
\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \hyperlink{class_a_m_r_level_mushy_layer_a6bba1599c6385bfc52087d65d83e2485}{m\+\_\+total\+Adv\+Vel}
\begin{DoxyCompactList}\small\item\em Frame advection velocity + fluid advection velocity. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a40949c8df12b362facb7aa3f1d879cf6}\label{class_a_m_r_level_mushy_layer_a40949c8df12b362facb7aa3f1d879cf6}} 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_a40949c8df12b362facb7aa3f1d879cf6}{A\+M\+R\+Salt\+Sum\+\_\+new}
\begin{DoxyCompactList}\small\item\em Total salt content in domain at new time. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a9e9671d353d9bdf3e9be0bdbb06bc2be}\label{class_a_m_r_level_mushy_layer_a9e9671d353d9bdf3e9be0bdbb06bc2be}} 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_a9e9671d353d9bdf3e9be0bdbb06bc2be}{A\+M\+R\+Salt\+Sum\+\_\+old}
\begin{DoxyCompactList}\small\item\em Total salt content in domain at old time. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a2826cb43a2acbc06d05ea5625aed4263}\label{class_a_m_r_level_mushy_layer_a2826cb43a2acbc06d05ea5625aed4263}} 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_a2826cb43a2acbc06d05ea5625aed4263}{A\+M\+R\+Enthalpy\+Sum\+\_\+new}
\begin{DoxyCompactList}\small\item\em Total heat content in domain at new time. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_abc6821ef9d09fddf0cd3e55fc0bb349d}\label{class_a_m_r_level_mushy_layer_abc6821ef9d09fddf0cd3e55fc0bb349d}} 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_abc6821ef9d09fddf0cd3e55fc0bb349d}{A\+M\+R\+Enthalpy\+Sum\+\_\+old}
\begin{DoxyCompactList}\small\item\em Total heat content in domain at new time. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a89f01be36bc140aaac63f16a74aa6e9a}\label{class_a_m_r_level_mushy_layer_a89f01be36bc140aaac63f16a74aa6e9a}} 
\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \hyperlink{class_a_m_r_level_mushy_layer_a89f01be36bc140aaac63f16a74aa6e9a}{m\+\_\+salt\+Flux\+Top}
\begin{DoxyCompactList}\small\item\em Salt flux at the top of the domain. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a3019ebcb233c3bdb4f1646e1f1022221}\label{class_a_m_r_level_mushy_layer_a3019ebcb233c3bdb4f1646e1f1022221}} 
\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \hyperlink{class_a_m_r_level_mushy_layer_a3019ebcb233c3bdb4f1646e1f1022221}{m\+\_\+salt\+Flux\+Bottom}
\begin{DoxyCompactList}\small\item\em Salt flux at the bottom of the domain. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a519fbccec0b9fa2dff32d9040c7d579d}\label{class_a_m_r_level_mushy_layer_a519fbccec0b9fa2dff32d9040c7d579d}} 
\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \hyperlink{class_a_m_r_level_mushy_layer_a519fbccec0b9fa2dff32d9040c7d579d}{m\+\_\+frame\+Vel}
\begin{DoxyCompactList}\small\item\em Frame velocity (cell centred). Don\textquotesingle{}t think we need this. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a3556903e5a8df44f5e8ad9113bb782a0}\label{class_a_m_r_level_mushy_layer_a3556903e5a8df44f5e8ad9113bb782a0}} 
\textbf{ Vector}$<$ int $>$ \hyperlink{class_a_m_r_level_mushy_layer_a3556903e5a8df44f5e8ad9113bb782a0}{m\+\_\+output\+Scalar\+Vars}
\begin{DoxyCompactList}\small\item\em \textbf{ List} of scalar vars to write out to H\+D\+F5 files. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a26eb81fbe2e9bcaf1d72099d4a15cc45}\label{class_a_m_r_level_mushy_layer_a26eb81fbe2e9bcaf1d72099d4a15cc45}} 
\textbf{ Vector}$<$ int $>$ \hyperlink{class_a_m_r_level_mushy_layer_a26eb81fbe2e9bcaf1d72099d4a15cc45}{m\+\_\+output\+Vector\+Vars}
\begin{DoxyCompactList}\small\item\em \textbf{ List} of vector vars to write out to H\+D\+F5 files. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a588ea6850fbe16d53bd496961ba5427b}\label{class_a_m_r_level_mushy_layer_a588ea6850fbe16d53bd496961ba5427b}} 
\textbf{ Vector}$<$ int $>$ \hyperlink{class_a_m_r_level_mushy_layer_a588ea6850fbe16d53bd496961ba5427b}{m\+\_\+chk\+Vector\+Vars}
\begin{DoxyCompactList}\small\item\em \textbf{ List} of vector vars to write to checkpoint files. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a8d09ec620023d399fcff3c8720d846c6}\label{class_a_m_r_level_mushy_layer_a8d09ec620023d399fcff3c8720d846c6}} 
\textbf{ Vector}$<$ int $>$ \hyperlink{class_a_m_r_level_mushy_layer_a8d09ec620023d399fcff3c8720d846c6}{m\+\_\+chk\+Scalar\+Vars}
\begin{DoxyCompactList}\small\item\em \textbf{ List} of scalar vars to write to checkpoint files. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a0f6d029ffba9fced9eea9b9abc193302}\label{class_a_m_r_level_mushy_layer_a0f6d029ffba9fced9eea9b9abc193302}} 
int \hyperlink{class_a_m_r_level_mushy_layer_a0f6d029ffba9fced9eea9b9abc193302}{m\+\_\+num\+Output\+Comps}
\begin{DoxyCompactList}\small\item\em Number of component we write out to H\+D\+F5 files. \end{DoxyCompactList}\item 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_a49000dfb8d30dc44b35fc1c802c9fd4c}{m\+\_\+max\+Lambda}
\begin{DoxyCompactList}\small\item\em Store max value of $ \lambda-1 $ from previous timestep. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a4937b8d2fdcfb86d57b7f197f91f5069}\label{class_a_m_r_level_mushy_layer_a4937b8d2fdcfb86d57b7f197f91f5069}} 
\textbf{ Vector}$<$ \textbf{ Ref\+Counted\+Ptr}$<$ \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ $>$ $>$ \hyperlink{class_a_m_r_level_mushy_layer_a4937b8d2fdcfb86d57b7f197f91f5069}{m\+\_\+scalar\+New}
\begin{DoxyCompactList}\small\item\em Scalar fields at new time. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ac46148c3e276d617167713088ffe0599}\label{class_a_m_r_level_mushy_layer_ac46148c3e276d617167713088ffe0599}} 
\textbf{ Vector}$<$ \textbf{ Ref\+Counted\+Ptr}$<$ \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ $>$ $>$ \hyperlink{class_a_m_r_level_mushy_layer_ac46148c3e276d617167713088ffe0599}{m\+\_\+scalar\+Old}
\begin{DoxyCompactList}\small\item\em Scalar fields at old time. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a05741bcf973b908f3defe7aa3de6dcc8}\label{class_a_m_r_level_mushy_layer_a05741bcf973b908f3defe7aa3de6dcc8}} 
\textbf{ Vector}$<$ \textbf{ Ref\+Counted\+Ptr}$<$ \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ $>$ $>$ \hyperlink{class_a_m_r_level_mushy_layer_a05741bcf973b908f3defe7aa3de6dcc8}{m\+\_\+scalar\+Restart}
\begin{DoxyCompactList}\small\item\em Backed up scalar fields to be used for restarting. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a29bc16b92f683fa1006932cdc417b9f5}\label{class_a_m_r_level_mushy_layer_a29bc16b92f683fa1006932cdc417b9f5}} 
\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \hyperlink{class_a_m_r_level_mushy_layer_a29bc16b92f683fa1006932cdc417b9f5}{m\+\_\+d\+Porosity\+\_\+dt}
\begin{DoxyCompactList}\small\item\em Lagged $ \partial \chi / \partial t $. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a3532d7906fe5e9bbdb42e6b861bd6f32}\label{class_a_m_r_level_mushy_layer_a3532d7906fe5e9bbdb42e6b861bd6f32}} 
\textbf{ Vector}$<$ \textbf{ Ref\+Counted\+Ptr}$<$ \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ $>$ $>$ \hyperlink{class_a_m_r_level_mushy_layer_a3532d7906fe5e9bbdb42e6b861bd6f32}{m\+\_\+vector\+New}
\begin{DoxyCompactList}\small\item\em \textbf{ Vector} fields at new time. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a3462ba31ff9fc2ea54892d9f0c9ee88b}\label{class_a_m_r_level_mushy_layer_a3462ba31ff9fc2ea54892d9f0c9ee88b}} 
\textbf{ Vector}$<$ \textbf{ Ref\+Counted\+Ptr}$<$ \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ $>$ $>$ \hyperlink{class_a_m_r_level_mushy_layer_a3462ba31ff9fc2ea54892d9f0c9ee88b}{m\+\_\+vector\+Old}
\begin{DoxyCompactList}\small\item\em \textbf{ Vector} fields at old time. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a728c07f2d1ab13e5e30f511f579786d1}\label{class_a_m_r_level_mushy_layer_a728c07f2d1ab13e5e30f511f579786d1}} 
\textbf{ Vector}$<$ \textbf{ Ref\+Counted\+Ptr}$<$ \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ $>$ $>$ \hyperlink{class_a_m_r_level_mushy_layer_a728c07f2d1ab13e5e30f511f579786d1}{m\+\_\+vector\+Restart}
\begin{DoxyCompactList}\small\item\em Backed up vector fields to be used for restarting. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ade5e5c646cf12ebaacd01f0a3ba137d9}\label{class_a_m_r_level_mushy_layer_ade5e5c646cf12ebaacd01f0a3ba137d9}} 
\textbf{ Vector}$<$ string $>$ \hyperlink{class_a_m_r_level_mushy_layer_ade5e5c646cf12ebaacd01f0a3ba137d9}{m\+\_\+scalar\+Var\+Names}
\begin{DoxyCompactList}\small\item\em Names of scalar variables. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a6f408f55473cdc50d4f5fa9c8cc5649b}\label{class_a_m_r_level_mushy_layer_a6f408f55473cdc50d4f5fa9c8cc5649b}} 
\textbf{ Vector}$<$ string $>$ \hyperlink{class_a_m_r_level_mushy_layer_a6f408f55473cdc50d4f5fa9c8cc5649b}{m\+\_\+vector\+Var\+Names}
\begin{DoxyCompactList}\small\item\em Names of vector variables. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ae0f3b5fdacca3dfa15f5b81bc2c8a9bb}\label{class_a_m_r_level_mushy_layer_ae0f3b5fdacca3dfa15f5b81bc2c8a9bb}} 
\textbf{ Vector}$<$ int $>$ \hyperlink{class_a_m_r_level_mushy_layer_ae0f3b5fdacca3dfa15f5b81bc2c8a9bb}{m\+\_\+vect\+Restart\+Vars}
\begin{DoxyCompactList}\small\item\em Indexes of vector fields to save for restarting. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a6edccc174db96d81222d583cccbb567a}\label{class_a_m_r_level_mushy_layer_a6edccc174db96d81222d583cccbb567a}} 
\textbf{ Vector}$<$ int $>$ \hyperlink{class_a_m_r_level_mushy_layer_a6edccc174db96d81222d583cccbb567a}{m\+\_\+scal\+Restart\+Vars}
\begin{DoxyCompactList}\small\item\em Indexes of scalar fields to save for restarting. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ad9fd7d782223f5734e4248dcc6a5d528}\label{class_a_m_r_level_mushy_layer_ad9fd7d782223f5734e4248dcc6a5d528}} 
\textbf{ Ref\+Counted\+Ptr}$<$ \textbf{ Level\+T\+GA} $>$ \hyperlink{class_a_m_r_level_mushy_layer_ad9fd7d782223f5734e4248dcc6a5d528}{m\+\_\+enthalpy\+Salinity\+T\+GA}
\begin{DoxyCompactList}\small\item\em T\+GA integrators (2nd order in time) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a8d1324b1db43fa3954c4eeef233198b1}\label{class_a_m_r_level_mushy_layer_a8d1324b1db43fa3954c4eeef233198b1}} 
\textbf{ Ref\+Counted\+Ptr}$<$ \textbf{ Level\+Backward\+Euler} $>$ \hyperlink{class_a_m_r_level_mushy_layer_a8d1324b1db43fa3954c4eeef233198b1}{m\+\_\+enthalpy\+Salinity\+BE}
\begin{DoxyCompactList}\small\item\em Backward Euler integrators (1st order in time) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a470122a7c3d162d76719424d581d8c03}\label{class_a_m_r_level_mushy_layer_a470122a7c3d162d76719424d581d8c03}} 
\textbf{ Ref\+Counted\+Ptr}$<$ \textbf{ A\+M\+R\+Multi\+Grid}$<$ \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ $>$ $>$ \hyperlink{class_a_m_r_level_mushy_layer_a470122a7c3d162d76719424d581d8c03}{m\+\_\+diffuse\+A\+M\+R\+MG} \mbox{[}\hyperlink{mushy_layer_opt_8h_afcada9fb65a998951da882b5c10191fea83db32f5839575c9d7812f3cd0727d07}{m\+\_\+num\+Scalar\+Vars}\mbox{]}
\begin{DoxyCompactList}\small\item\em A\+M\+R\+Multigrid operators for each scalar. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a6bc554772da0dc80eb3674e1817a309b}\label{class_a_m_r_level_mushy_layer_a6bc554772da0dc80eb3674e1817a309b}} 
\textbf{ Ref\+Counted\+Ptr}$<$ \textbf{ A\+M\+R\+F\+A\+S\+Multi\+Grid}$<$ \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ $>$ $>$ \hyperlink{class_a_m_r_level_mushy_layer_a6bc554772da0dc80eb3674e1817a309b}{m\+\_\+diffuse\+A\+M\+R\+F\+A\+S\+MG} \mbox{[}\hyperlink{mushy_layer_opt_8h_afcada9fb65a998951da882b5c10191fea83db32f5839575c9d7812f3cd0727d07}{m\+\_\+num\+Scalar\+Vars}\mbox{]}
\begin{DoxyCompactList}\small\item\em F\+A\+S\+A\+M\+R\+Multigrid operators for each scalar. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_acb712abf9ec7866298cf3ea78465fc19}\label{class_a_m_r_level_mushy_layer_acb712abf9ec7866298cf3ea78465fc19}} 
\textbf{ Ref\+Counted\+Ptr}$<$ \textbf{ A\+M\+R\+F\+A\+S\+Multi\+Grid}$<$ \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ $>$ $>$ \hyperlink{class_a_m_r_level_mushy_layer_acb712abf9ec7866298cf3ea78465fc19}{m\+\_\+multi\+Comp\+F\+A\+S\+MG}
\begin{DoxyCompactList}\small\item\em Multicomponent F\+AS Multigrid solver (for enthalpy-\/bulk concentration solves) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a29d239440437c973f79bd67dd2261cf4}\label{class_a_m_r_level_mushy_layer_a29d239440437c973f79bd67dd2261cf4}} 
\textbf{ Ref\+Counted\+Ptr}$<$ \textbf{ A\+M\+R\+Level\+Op\+Factory}$<$ \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ $>$ $>$ \hyperlink{class_a_m_r_level_mushy_layer_a29d239440437c973f79bd67dd2261cf4}{m\+\_\+\+H\+C\+Op\+Fact}
\begin{DoxyCompactList}\small\item\em Operator factories for scalar vars. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a8da3f229eb6d77528db83ea3ac696be5}\label{class_a_m_r_level_mushy_layer_a8da3f229eb6d77528db83ea3ac696be5}} 
\textbf{ Ref\+Counted\+Ptr}$<$ \textbf{ A\+M\+R\+Multi\+Grid}$<$ \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ $>$ $>$ \hyperlink{class_a_m_r_level_mushy_layer_a8da3f229eb6d77528db83ea3ac696be5}{m\+\_\+u\+Star\+A\+M\+R\+MG} \mbox{[}\textbf{ Space\+Dim}\mbox{]}
\begin{DoxyCompactList}\small\item\em A\+M\+R\+Multigrid solver for unprojected velocity, $ \mathbf{u}^* $. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a3450c57623aeb32049ce4a8928597209}\label{class_a_m_r_level_mushy_layer_a3450c57623aeb32049ce4a8928597209}} 
\textbf{ Ref\+Counted\+Ptr}$<$ \textbf{ A\+M\+R\+Level\+Op\+Factory}$<$ \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ $>$ $>$ \hyperlink{class_a_m_r_level_mushy_layer_a3450c57623aeb32049ce4a8928597209}{m\+\_\+u\+Star\+Op\+Fact} \mbox{[}\textbf{ Space\+Dim}\mbox{]}
\begin{DoxyCompactList}\small\item\em Operator factory for unprojected velocity, $ \mathbf{u}^* $. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a4d91e3fa25799fc66e74808c545892b6}\label{class_a_m_r_level_mushy_layer_a4d91e3fa25799fc66e74808c545892b6}} 
\textbf{ Ref\+Counted\+Ptr}$<$ \textbf{ A\+M\+R\+Poisson\+Op} $>$ \hyperlink{class_a_m_r_level_mushy_layer_a4d91e3fa25799fc66e74808c545892b6}{m\+\_\+viscous\+Op} \mbox{[}\textbf{ Space\+Dim}\mbox{]}
\begin{DoxyCompactList}\small\item\em Operator for computing components of $ \nabla^2 \mathbf{u} $. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a6b8c2c0a55b677d826818cf7f26128aa}\label{class_a_m_r_level_mushy_layer_a6b8c2c0a55b677d826818cf7f26128aa}} 
bool \hyperlink{class_a_m_r_level_mushy_layer_a6b8c2c0a55b677d826818cf7f26128aa}{m\+\_\+is\+Defined}
\begin{DoxyCompactList}\small\item\em Is object defined. \end{DoxyCompactList}\item 
\hyperlink{struct_mushy_layer_options}{Mushy\+Layer\+Options} \hyperlink{class_a_m_r_level_mushy_layer_a3652e6785ac8c5e429a5ac286ea3bc2e}{m\+\_\+opt}
\begin{DoxyCompactList}\small\item\em Struct to contain all the options for this simulation. \end{DoxyCompactList}\item 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_aa7a6e8a5cb2cb6f690c047e46d70547f}{m\+\_\+computed\+C\+FL}
\begin{DoxyCompactList}\small\item\em The C\+FL number we\textquotesingle{}re currently running at. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a84fc3ef3cdbf715c83ff6d78293e9fee}\label{class_a_m_r_level_mushy_layer_a84fc3ef3cdbf715c83ff6d78293e9fee}} 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_a84fc3ef3cdbf715c83ff6d78293e9fee}{m\+\_\+domain\+Width}
\begin{DoxyCompactList}\small\item\em Domain width. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aa662bb49cb6956efb2998484054c2281}\label{class_a_m_r_level_mushy_layer_aa662bb49cb6956efb2998484054c2281}} 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_aa662bb49cb6956efb2998484054c2281}{m\+\_\+domain\+Height}
\begin{DoxyCompactList}\small\item\em Domain height. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a3b0c04c2f96d9a9ad8bf7dde59b91264}\label{class_a_m_r_level_mushy_layer_a3b0c04c2f96d9a9ad8bf7dde59b91264}} 
\textbf{ Int\+Vect} \hyperlink{class_a_m_r_level_mushy_layer_a3b0c04c2f96d9a9ad8bf7dde59b91264}{m\+\_\+num\+Cells}
\begin{DoxyCompactList}\small\item\em Number of cells in each direction of domain. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a65a0a5abcc272ba9634034ff0fae81d8}\label{class_a_m_r_level_mushy_layer_a65a0a5abcc272ba9634034ff0fae81d8}} 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_a65a0a5abcc272ba9634034ff0fae81d8}{m\+\_\+max\+\_\+dt\+\_\+growth}
\begin{DoxyCompactList}\small\item\em Maxmimum fractional growth in $ \Delta t $ between timesteps. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a5afc0cf82e7f6ccff19bcd39751308f6}\label{class_a_m_r_level_mushy_layer_a5afc0cf82e7f6ccff19bcd39751308f6}} 
bool \hyperlink{class_a_m_r_level_mushy_layer_a5afc0cf82e7f6ccff19bcd39751308f6}{m\+\_\+use\+Limiting}
\begin{DoxyCompactList}\small\item\em Should we do slope limiting in advection solves? \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a6e8ce82a43920d2e8bcca5aab6b4ac5e}\label{class_a_m_r_level_mushy_layer_a6e8ce82a43920d2e8bcca5aab6b4ac5e}} 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_a6e8ce82a43920d2e8bcca5aab6b4ac5e}{m\+\_\+dx}
\begin{DoxyCompactList}\small\item\em Cell spacing. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_afb12e6063552f8629a5d81fbac6ac20b}\label{class_a_m_r_level_mushy_layer_afb12e6063552f8629a5d81fbac6ac20b}} 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_afb12e6063552f8629a5d81fbac6ac20b}{m\+\_\+scalar\+Diffusion\+Coeffs} \mbox{[}\hyperlink{mushy_layer_opt_8h_afcada9fb65a998951da882b5c10191fea83db32f5839575c9d7812f3cd0727d07}{m\+\_\+num\+Scalar\+Vars}\mbox{]}
\begin{DoxyCompactList}\small\item\em Diffusion coefficients for different scalar fields. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_abe361484bd04d3be84f4c3a0c96d896d}\label{class_a_m_r_level_mushy_layer_abe361484bd04d3be84f4c3a0c96d896d}} 
\hyperlink{class_mushy_layer_params}{Mushy\+Layer\+Params} \hyperlink{class_a_m_r_level_mushy_layer_abe361484bd04d3be84f4c3a0c96d896d}{m\+\_\+parameters}
\begin{DoxyCompactList}\small\item\em Physical parameters. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ac8b6ab9b6a0ad4593c013fd10700e5a6}\label{class_a_m_r_level_mushy_layer_ac8b6ab9b6a0ad4593c013fd10700e5a6}} 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_ac8b6ab9b6a0ad4593c013fd10700e5a6}{m\+\_\+prev\+\_\+diag\+\_\+output}
\begin{DoxyCompactList}\small\item\em Time when we last produced diagnostics output. \end{DoxyCompactList}\item 
bool \hyperlink{class_a_m_r_level_mushy_layer_a731a16b4dfaecb9235357b88e251af97}{m\+\_\+enforce\+GradP}
\begin{DoxyCompactList}\small\item\em Should we enforce some analytic $ \nabla P $. \end{DoxyCompactList}\item 
bool \hyperlink{class_a_m_r_level_mushy_layer_af6dd293bd80f201846fc7d6fe6f851b1}{m\+\_\+use\+Prev\+Pressure\+For\+U\+Star}
\begin{DoxyCompactList}\small\item\em Should we use previous $ \nabla P $ to calculate $ \mathbf{u}^* $. \end{DoxyCompactList}\item 
int \hyperlink{class_a_m_r_level_mushy_layer_a53408b847afbe94238f1f19daf166f2f}{m\+\_\+pressure\+Scale\+Var}
\begin{DoxyCompactList}\small\item\em Which field scales the pressure. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a556d09747dccd10f54abbf691c058bb5}\label{class_a_m_r_level_mushy_layer_a556d09747dccd10f54abbf691c058bb5}} 
\hyperlink{class_phys_b_c_util}{Phys\+B\+C\+Util} $\ast$ \hyperlink{class_a_m_r_level_mushy_layer_a556d09747dccd10f54abbf691c058bb5}{m\+\_\+phys\+B\+C\+Ptr}
\begin{DoxyCompactList}\small\item\em Pointer to physics boundary condition object. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a44fb7624096c8143df1c09e062d57fbf}\label{class_a_m_r_level_mushy_layer_a44fb7624096c8143df1c09e062d57fbf}} 
\textbf{ Fine\+Interp} \hyperlink{class_a_m_r_level_mushy_layer_a44fb7624096c8143df1c09e062d57fbf}{m\+\_\+fine\+Interp\+Scalar}
\begin{DoxyCompactList}\small\item\em For interpolating scalars from coarser grids. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a9d616c357ecbe1098998feae5ffefa18}\label{class_a_m_r_level_mushy_layer_a9d616c357ecbe1098998feae5ffefa18}} 
\textbf{ Fine\+Interp} \hyperlink{class_a_m_r_level_mushy_layer_a9d616c357ecbe1098998feae5ffefa18}{m\+\_\+fine\+Interp\+Vector}
\begin{DoxyCompactList}\small\item\em For interpolating vectors from coarser grids. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_af0e2d84fa6c2cf813bf25f1bb4c880ab}\label{class_a_m_r_level_mushy_layer_af0e2d84fa6c2cf813bf25f1bb4c880ab}} 
\textbf{ Coarse\+Average} \hyperlink{class_a_m_r_level_mushy_layer_af0e2d84fa6c2cf813bf25f1bb4c880ab}{m\+\_\+coarse\+Average\+Scalar}
\begin{DoxyCompactList}\small\item\em For averaging scalars to coarse grids. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a22ba6f41aa7c557ac01cf6cb9e5fc8c9}\label{class_a_m_r_level_mushy_layer_a22ba6f41aa7c557ac01cf6cb9e5fc8c9}} 
\textbf{ Coarse\+Average} \hyperlink{class_a_m_r_level_mushy_layer_a22ba6f41aa7c557ac01cf6cb9e5fc8c9}{m\+\_\+coarse\+Average\+HC}
\begin{DoxyCompactList}\small\item\em For 2 component enthalpy-\/salinity fields. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a992715b841cd44d7dbb64cd99acb9306}\label{class_a_m_r_level_mushy_layer_a992715b841cd44d7dbb64cd99acb9306}} 
\textbf{ Coarse\+Average} \hyperlink{class_a_m_r_level_mushy_layer_a992715b841cd44d7dbb64cd99acb9306}{m\+\_\+coarse\+Average\+Vector}
\begin{DoxyCompactList}\small\item\em For averaging vectors to coarse grids. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aaaff66ec4a08d3d90fdee05a2a67cede}\label{class_a_m_r_level_mushy_layer_aaaff66ec4a08d3d90fdee05a2a67cede}} 
bool \hyperlink{class_a_m_r_level_mushy_layer_aaaff66ec4a08d3d90fdee05a2a67cede}{m\+\_\+timestep\+Reduced}
\begin{DoxyCompactList}\small\item\em For reducing the timestep after a failed timestep. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a514c73fd99d14fb7e4ce39b50636f6ce}\label{class_a_m_r_level_mushy_layer_a514c73fd99d14fb7e4ce39b50636f6ce}} 
int \hyperlink{class_a_m_r_level_mushy_layer_a514c73fd99d14fb7e4ce39b50636f6ce}{m\+\_\+dt\+Reduction}
\begin{DoxyCompactList}\small\item\em Factor reduce $ \Delta t $ by after a failed timestep. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_abf254beee2f05065819e03b76e824d04}\label{class_a_m_r_level_mushy_layer_abf254beee2f05065819e03b76e824d04}} 
bool \hyperlink{class_a_m_r_level_mushy_layer_abf254beee2f05065819e03b76e824d04}{m\+\_\+timestep\+Failed}
\begin{DoxyCompactList}\small\item\em Has this timestep failed? \end{DoxyCompactList}\item 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_af41eb6058681e1345ce40633dd9fde1f}{m\+\_\+adv\+\_\+vel\+\_\+centering}
\begin{DoxyCompactList}\small\item\em If this level has only just been added due to regridding. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a532678009eb6a62cb967f6578c88fef6}\label{class_a_m_r_level_mushy_layer_a532678009eb6a62cb967f6578c88fef6}} 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_a532678009eb6a62cb967f6578c88fef6}{m\+\_\+adv\+\_\+vel\+\_\+centering\+\_\+growth}
\begin{DoxyCompactList}\small\item\em Rate at which we grow m\+\_\+adv\+\_\+vel\+\_\+centering each timestep. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aef47162bc24ba3eccffb5f7319c4d19d}\label{class_a_m_r_level_mushy_layer_aef47162bc24ba3eccffb5f7319c4d19d}} 
\textbf{ Quad\+C\+F\+Interp} \hyperlink{class_a_m_r_level_mushy_layer_aef47162bc24ba3eccffb5f7319c4d19d}{m\+\_\+quad\+C\+F\+Interp\+Scalar}
\begin{DoxyCompactList}\small\item\em For doing quadratic interpolation at coarse fine boundaries (for scalars) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a95cbb370eeaed9cd89e03dbf57d69988}\label{class_a_m_r_level_mushy_layer_a95cbb370eeaed9cd89e03dbf57d69988}} 
\textbf{ Quad\+C\+F\+Interp} \hyperlink{class_a_m_r_level_mushy_layer_a95cbb370eeaed9cd89e03dbf57d69988}{m\+\_\+quad\+C\+F\+Interp\+Vector}
\begin{DoxyCompactList}\small\item\em For doing quadratic interpolation at coarse fine boundaries (for vectors) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_abc59bddccf6b536b195c6abde9e9d43b}\label{class_a_m_r_level_mushy_layer_abc59bddccf6b536b195c6abde9e9d43b}} 
\textbf{ Piecewise\+Linear\+Fill\+Patch} \hyperlink{class_a_m_r_level_mushy_layer_abc59bddccf6b536b195c6abde9e9d43b}{m\+\_\+piecewise\+Linear\+Fill\+Patch\+Scalar\+One}
\begin{DoxyCompactList}\small\item\em For filling one ghost cell around the edge of a set of boxes on a level. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a6fcadf643df6101f6afe8b5bd02f2ed9}\label{class_a_m_r_level_mushy_layer_a6fcadf643df6101f6afe8b5bd02f2ed9}} 
\textbf{ Piecewise\+Linear\+Fill\+Patch} \hyperlink{class_a_m_r_level_mushy_layer_a6fcadf643df6101f6afe8b5bd02f2ed9}{m\+\_\+piecewise\+Linear\+Fill\+Patch\+Scalar\+Two}
\begin{DoxyCompactList}\small\item\em For filling two ghost cells around the edge of a set of boxes on a level. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_abcee4b91b783bddf5ae1f09241cd541b}\label{class_a_m_r_level_mushy_layer_abcee4b91b783bddf5ae1f09241cd541b}} 
\textbf{ Piecewise\+Linear\+Fill\+Patch} \hyperlink{class_a_m_r_level_mushy_layer_abcee4b91b783bddf5ae1f09241cd541b}{m\+\_\+piecewise\+Linear\+Fill\+Patch\+Scalar\+Three}
\begin{DoxyCompactList}\small\item\em For filling three ghost cells around the edge of a set of boxes on a level. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a0a3e3a06973c6e07439953cdcde42275}\label{class_a_m_r_level_mushy_layer_a0a3e3a06973c6e07439953cdcde42275}} 
\textbf{ Piecewise\+Linear\+Fill\+Patch} \hyperlink{class_a_m_r_level_mushy_layer_a0a3e3a06973c6e07439953cdcde42275}{m\+\_\+piecewise\+Linear\+Fill\+Patch\+Scalar\+Four}
\begin{DoxyCompactList}\small\item\em For filling four ghost cells around the edge of a set of boxes on a level. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aba35ef990a5a51e81af28856f9bfd095}\label{class_a_m_r_level_mushy_layer_aba35ef990a5a51e81af28856f9bfd095}} 
int \hyperlink{class_a_m_r_level_mushy_layer_aba35ef990a5a51e81af28856f9bfd095}{m\+\_\+num\+Ghost}
\begin{DoxyCompactList}\small\item\em Number of ghost cells for standard calculations. \end{DoxyCompactList}\item 
int \hyperlink{class_a_m_r_level_mushy_layer_a5ac61ca83db82c5642e21d7cbe83f37b}{m\+\_\+num\+Ghost\+Advection}
\begin{DoxyCompactList}\small\item\em Number of ghost cells for advection calculations. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a90acda5f43d2b66e4bcbd989f9354b1b}\label{class_a_m_r_level_mushy_layer_a90acda5f43d2b66e4bcbd989f9354b1b}} 
\textbf{ Patch\+Godunov} \hyperlink{class_a_m_r_level_mushy_layer_a90acda5f43d2b66e4bcbd989f9354b1b}{m\+\_\+patch\+God\+Velocity}
\begin{DoxyCompactList}\small\item\em Handles advection of velocity. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a75f21997491a30f17dfd30f2dd6b3967}\label{class_a_m_r_level_mushy_layer_a75f21997491a30f17dfd30f2dd6b3967}} 
\textbf{ Patch\+Godunov} \hyperlink{class_a_m_r_level_mushy_layer_a75f21997491a30f17dfd30f2dd6b3967}{m\+\_\+patch\+God\+HC}
\begin{DoxyCompactList}\small\item\em Operator For multi component H-\/C advection solve. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a40f638ac59f7b05a5832d28ec2aa9ea6}\label{class_a_m_r_level_mushy_layer_a40f638ac59f7b05a5832d28ec2aa9ea6}} 
\textbf{ Patch\+Godunov} \hyperlink{class_a_m_r_level_mushy_layer_a40f638ac59f7b05a5832d28ec2aa9ea6}{m\+\_\+patch\+God\+T\+Sl}
\begin{DoxyCompactList}\small\item\em Operator For multi component T-\/\+Sl advection solve. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a8f211bc8b76a04f3be8ab05725179b8c}\label{class_a_m_r_level_mushy_layer_a8f211bc8b76a04f3be8ab05725179b8c}} 
\textbf{ Patch\+Godunov} \hyperlink{class_a_m_r_level_mushy_layer_a8f211bc8b76a04f3be8ab05725179b8c}{m\+\_\+patch\+GodH}
\begin{DoxyCompactList}\small\item\em Operator For single component H advection solve. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_af6f10ce77edec7cf1643c7c58cbd9ca5}\label{class_a_m_r_level_mushy_layer_af6f10ce77edec7cf1643c7c58cbd9ca5}} 
\textbf{ Patch\+Godunov} \hyperlink{class_a_m_r_level_mushy_layer_af6f10ce77edec7cf1643c7c58cbd9ca5}{m\+\_\+patch\+GodC}
\begin{DoxyCompactList}\small\item\em Operator For single component C advection solve. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a5d5421485cb631a1031662bc2970b8b2}\label{class_a_m_r_level_mushy_layer_a5d5421485cb631a1031662bc2970b8b2}} 
\textbf{ Patch\+Godunov} \hyperlink{class_a_m_r_level_mushy_layer_a5d5421485cb631a1031662bc2970b8b2}{m\+\_\+patch\+GodT}
\begin{DoxyCompactList}\small\item\em Operator For single component T advection solve. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aaf69aef4a8257992ca9a178fc9e3789c}\label{class_a_m_r_level_mushy_layer_aaf69aef4a8257992ca9a178fc9e3789c}} 
\textbf{ Patch\+Godunov} \hyperlink{class_a_m_r_level_mushy_layer_aaf69aef4a8257992ca9a178fc9e3789c}{m\+\_\+patch\+God\+Sl}
\begin{DoxyCompactList}\small\item\em Operator For single component Sl advection solve. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a233972001b8206d301933423130a7c61}\label{class_a_m_r_level_mushy_layer_a233972001b8206d301933423130a7c61}} 
\hyperlink{class_advection_physics}{Advection\+Physics} \hyperlink{class_a_m_r_level_mushy_layer_a233972001b8206d301933423130a7c61}{m\+\_\+advection\+Physics\+Velocity}
\begin{DoxyCompactList}\small\item\em Physics for velocity advection. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a7e25d8921ac7ab01740ed65b021d0e79}\label{class_a_m_r_level_mushy_layer_a7e25d8921ac7ab01740ed65b021d0e79}} 
\hyperlink{class_advection_physics}{Advection\+Physics} \hyperlink{class_a_m_r_level_mushy_layer_a7e25d8921ac7ab01740ed65b021d0e79}{m\+\_\+adv\+Phys\+HC}
\begin{DoxyCompactList}\small\item\em Physics for coupled H-\/C advection solve. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_acc1771419f8ae45a0303d8315e80798b}\label{class_a_m_r_level_mushy_layer_acc1771419f8ae45a0303d8315e80798b}} 
\hyperlink{class_advection_physics}{Advection\+Physics} \hyperlink{class_a_m_r_level_mushy_layer_acc1771419f8ae45a0303d8315e80798b}{m\+\_\+adv\+Phys\+T\+Sl}
\begin{DoxyCompactList}\small\item\em Physics for coupled T-\/\+Sl advection solve. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a12e1e6883d371f38d0ad9e1f8094c3a0}\label{class_a_m_r_level_mushy_layer_a12e1e6883d371f38d0ad9e1f8094c3a0}} 
\hyperlink{class_advection_physics}{Advection\+Physics} \hyperlink{class_a_m_r_level_mushy_layer_a12e1e6883d371f38d0ad9e1f8094c3a0}{m\+\_\+adv\+PhysH}
\begin{DoxyCompactList}\small\item\em Physics for H advection solve. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aa34869335db20c8d9e78b2fa7489ad9f}\label{class_a_m_r_level_mushy_layer_aa34869335db20c8d9e78b2fa7489ad9f}} 
\hyperlink{class_advection_physics}{Advection\+Physics} \hyperlink{class_a_m_r_level_mushy_layer_aa34869335db20c8d9e78b2fa7489ad9f}{m\+\_\+adv\+PhysC}
\begin{DoxyCompactList}\small\item\em Physics for C advection solve. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aeed83b5ab64ca1c98478753602ebbd40}\label{class_a_m_r_level_mushy_layer_aeed83b5ab64ca1c98478753602ebbd40}} 
\hyperlink{class_advection_physics}{Advection\+Physics} \hyperlink{class_a_m_r_level_mushy_layer_aeed83b5ab64ca1c98478753602ebbd40}{m\+\_\+adv\+PhysT}
\begin{DoxyCompactList}\small\item\em Physics for T advection solve. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a6f0d3470a6089238d42a6eb3a2222142}\label{class_a_m_r_level_mushy_layer_a6f0d3470a6089238d42a6eb3a2222142}} 
\hyperlink{class_advection_physics}{Advection\+Physics} \hyperlink{class_a_m_r_level_mushy_layer_a6f0d3470a6089238d42a6eb3a2222142}{m\+\_\+adv\+Phys\+Sl}
\begin{DoxyCompactList}\small\item\em Physics for Sl advection solve. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a624292a7c8fa00de496a75a9816d8f29}\label{class_a_m_r_level_mushy_layer_a624292a7c8fa00de496a75a9816d8f29}} 
\textbf{ Ref\+Counted\+Ptr}$<$ \textbf{ Patch\+Godunov} $>$ \hyperlink{class_a_m_r_level_mushy_layer_a624292a7c8fa00de496a75a9816d8f29}{m\+\_\+patch\+God\+Scalars} \mbox{[}\hyperlink{mushy_layer_opt_8h_afcada9fb65a998951da882b5c10191fea83db32f5839575c9d7812f3cd0727d07}{m\+\_\+num\+Scalar\+Vars}\mbox{]}
\begin{DoxyCompactList}\small\item\em Handles advection of scalar vars. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aff6179584bf6eaa3c6c016f03e23ba48}\label{class_a_m_r_level_mushy_layer_aff6179584bf6eaa3c6c016f03e23ba48}} 
\textbf{ Phys\+I\+BC} $\ast$ \hyperlink{class_a_m_r_level_mushy_layer_aff6179584bf6eaa3c6c016f03e23ba48}{m\+\_\+scalar\+I\+BC} \mbox{[}\hyperlink{mushy_layer_opt_8h_afcada9fb65a998951da882b5c10191fea83db32f5839575c9d7812f3cd0727d07}{m\+\_\+num\+Scalar\+Vars}\mbox{]}
\begin{DoxyCompactList}\small\item\em Initial and Boundary Conditions for scalar vars. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a2eb89664c4fab25c758e1eb80ad7edbb}\label{class_a_m_r_level_mushy_layer_a2eb89664c4fab25c758e1eb80ad7edbb}} 
\hyperlink{class_projector}{Projector} \hyperlink{class_a_m_r_level_mushy_layer_a2eb89664c4fab25c758e1eb80ad7edbb}{m\+\_\+projection}
\begin{DoxyCompactList}\small\item\em Handles pressure projection. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a7823bcf21f31a94608f186498d96714c}\label{class_a_m_r_level_mushy_layer_a7823bcf21f31a94608f186498d96714c}} 
\hyperlink{class_projector}{Projector} \hyperlink{class_a_m_r_level_mushy_layer_a7823bcf21f31a94608f186498d96714c}{m\+\_\+projection\+Backup}
\begin{DoxyCompactList}\small\item\em Contains the old pressure, in case we need to restart. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a415e82d9a6e78b645eef60b573aec79e}\label{class_a_m_r_level_mushy_layer_a415e82d9a6e78b645eef60b573aec79e}} 
\textbf{ Ref\+Counted\+Ptr}$<$ \textbf{ Level\+Flux\+Register} $>$ \hyperlink{class_a_m_r_level_mushy_layer_a415e82d9a6e78b645eef60b573aec79e}{m\+\_\+flux\+Registers} \mbox{[}\hyperlink{mushy_layer_opt_8h_afcada9fb65a998951da882b5c10191fea83db32f5839575c9d7812f3cd0727d07}{m\+\_\+num\+Scalar\+Vars}\mbox{]}
\begin{DoxyCompactList}\small\item\em Flux registers for scalar variables. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aeaa3fd2d4ab926288073064170e791f3}\label{class_a_m_r_level_mushy_layer_aeaa3fd2d4ab926288073064170e791f3}} 
\textbf{ Ref\+Counted\+Ptr}$<$ \textbf{ Level\+Flux\+Register} $>$ \hyperlink{class_a_m_r_level_mushy_layer_aeaa3fd2d4ab926288073064170e791f3}{m\+\_\+flux\+Reg\+HC}
\begin{DoxyCompactList}\small\item\em Flux Register for multi component HC solves. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ab6d6bc6e97ec3b0bdfe4a13de762f48c}\label{class_a_m_r_level_mushy_layer_ab6d6bc6e97ec3b0bdfe4a13de762f48c}} 
\textbf{ Ref\+Counted\+Ptr}$<$ \textbf{ Level\+Flux\+Register} $>$ \hyperlink{class_a_m_r_level_mushy_layer_ab6d6bc6e97ec3b0bdfe4a13de762f48c}{m\+\_\+vector\+Flux\+Registers} \mbox{[}\hyperlink{mushy_layer_opt_8h_ad67b5b87e24a070e739a68078dcb7520a0bc95e626dcdeae398d6bb728b28578f}{m\+\_\+num\+Vector\+Vars}\mbox{]}
\begin{DoxyCompactList}\small\item\em Flux registers for vector variables. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a7f0dd62b216d0ab459d2f8469297c852}\label{class_a_m_r_level_mushy_layer_a7f0dd62b216d0ab459d2f8469297c852}} 
\hyperlink{class_level_domain_flux_register}{Level\+Domain\+Flux\+Register} \hyperlink{class_a_m_r_level_mushy_layer_a7f0dd62b216d0ab459d2f8469297c852}{m\+\_\+salt\+Domain\+Flux\+Register}
\begin{DoxyCompactList}\small\item\em Flux register for salt along the domain edge. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a12005aabbc909314eba74afaba3a9188}\label{class_a_m_r_level_mushy_layer_a12005aabbc909314eba74afaba3a9188}} 
\hyperlink{class_level_domain_flux_register}{Level\+Domain\+Flux\+Register} \hyperlink{class_a_m_r_level_mushy_layer_a12005aabbc909314eba74afaba3a9188}{m\+\_\+heat\+Domain\+Flux\+Register}
\begin{DoxyCompactList}\small\item\em Flux register for heat (enthalpy) along the domain edge. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a934fadf749cd979e03db2a084450ae73}\label{class_a_m_r_level_mushy_layer_a934fadf749cd979e03db2a084450ae73}} 
bool \hyperlink{class_a_m_r_level_mushy_layer_a934fadf749cd979e03db2a084450ae73}{m\+\_\+make\+Flux\+Reg\+For\+Scalar\+Var} \mbox{[}\hyperlink{mushy_layer_opt_8h_afcada9fb65a998951da882b5c10191fea83db32f5839575c9d7812f3cd0727d07}{m\+\_\+num\+Scalar\+Vars}\mbox{]}
\begin{DoxyCompactList}\small\item\em Which scalar vars should we bother making flux registers for? \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_adc0b73ca3269c4015bcc31850ab50785}\label{class_a_m_r_level_mushy_layer_adc0b73ca3269c4015bcc31850ab50785}} 
bool \hyperlink{class_a_m_r_level_mushy_layer_adc0b73ca3269c4015bcc31850ab50785}{m\+\_\+make\+Flux\+Reg\+For\+Vector\+Var} \mbox{[}\hyperlink{mushy_layer_opt_8h_ad67b5b87e24a070e739a68078dcb7520a0bc95e626dcdeae398d6bb728b28578f}{m\+\_\+num\+Vector\+Vars}\mbox{]}
\begin{DoxyCompactList}\small\item\em Which vector vars should we bother making flux registers for? \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a3b035a45d271c4c771406dc0f181d44e}\label{class_a_m_r_level_mushy_layer_a3b035a45d271c4c771406dc0f181d44e}} 
bool \hyperlink{class_a_m_r_level_mushy_layer_a3b035a45d271c4c771406dc0f181d44e}{m\+\_\+has\+Coarser}
\begin{DoxyCompactList}\small\item\em Does a coarser \hyperlink{class_a_m_r_level_mushy_layer}{A\+M\+R\+Level\+Mushy\+Layer} pointer exist? \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a4ae86c69a9100a32c7cc278100a534ee}\label{class_a_m_r_level_mushy_layer_a4ae86c69a9100a32c7cc278100a534ee}} 
bool \hyperlink{class_a_m_r_level_mushy_layer_a4ae86c69a9100a32c7cc278100a534ee}{m\+\_\+has\+Finer}
\begin{DoxyCompactList}\small\item\em Does a finer \hyperlink{class_a_m_r_level_mushy_layer}{A\+M\+R\+Level\+Mushy\+Layer} pointer exist? \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a1099c89fd5bc80bf46eea1823a0d3ae3}\label{class_a_m_r_level_mushy_layer_a1099c89fd5bc80bf46eea1823a0d3ae3}} 
\textbf{ Disjoint\+Box\+Layout} \hyperlink{class_a_m_r_level_mushy_layer_a1099c89fd5bc80bf46eea1823a0d3ae3}{m\+\_\+grids}
\begin{DoxyCompactList}\small\item\em Grids on this level. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a8eec8d2d864c28268839fd35d1788cb4}\label{class_a_m_r_level_mushy_layer_a8eec8d2d864c28268839fd35d1788cb4}} 
bool \hyperlink{class_a_m_r_level_mushy_layer_a8eec8d2d864c28268839fd35d1788cb4}{m\+\_\+new\+Grids\+\_\+different}
\begin{DoxyCompactList}\small\item\em Are the new grids different from current ones? \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a4c79c5e47b397340a7e682026e1a2081}\label{class_a_m_r_level_mushy_layer_a4c79c5e47b397340a7e682026e1a2081}} 
bool \hyperlink{class_a_m_r_level_mushy_layer_a4c79c5e47b397340a7e682026e1a2081}{m\+\_\+regrid\+\_\+smoothing\+\_\+done}
\begin{DoxyCompactList}\small\item\em Has post regrid smoothing been done? \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a834319f2bb3eceeafa4d3db231ffe5a2}\label{class_a_m_r_level_mushy_layer_a834319f2bb3eceeafa4d3db231ffe5a2}} 
\textbf{ Real} \hyperlink{class_a_m_r_level_mushy_layer_a834319f2bb3eceeafa4d3db231ffe5a2}{s\+\_\+regrid\+\_\+smoothing\+\_\+coeff}
\begin{DoxyCompactList}\small\item\em Coefficient for post regrid smoothing. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ae045eef1c0046ddff09f2dea5b127522}\label{class_a_m_r_level_mushy_layer_ae045eef1c0046ddff09f2dea5b127522}} 
bool \hyperlink{class_a_m_r_level_mushy_layer_ae045eef1c0046ddff09f2dea5b127522}{s\+\_\+implicit\+\_\+reflux}
\begin{DoxyCompactList}\small\item\em Do reflux implicitly? \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Static Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a8c41332c0723be5608b2c308f1585762}\label{class_a_m_r_level_mushy_layer_a8c41332c0723be5608b2c308f1585762}} 
static \textbf{ Bi\+C\+G\+Stab\+Solver}$<$ \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ $>$ \hyperlink{class_a_m_r_level_mushy_layer_a8c41332c0723be5608b2c308f1585762}{s\+\_\+bot\+Solver\+U\+Star}
\begin{DoxyCompactList}\small\item\em bottom solver for velocity solve multigrid \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a34e8f8e515803111478323d176db5643}\label{class_a_m_r_level_mushy_layer_a34e8f8e515803111478323d176db5643}} 
static \textbf{ Relax\+Solver}$<$ \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ $>$ \hyperlink{class_a_m_r_level_mushy_layer_a34e8f8e515803111478323d176db5643}{s\+\_\+bot\+Solver\+HC}
\begin{DoxyCompactList}\small\item\em Bottom solve for enthalpy-\/bulk concentration multigrid. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}
\textbf{ A\+M\+R\+Level} for mushy layer calculations. 

Big class to manage integration of nonlinear mushy layer equations on an \textbf{ A\+MR} level 

\subsection{Member Enumeration Documentation}
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ae580be53bf92a5bad64ba0032282458b}\label{class_a_m_r_level_mushy_layer_ae580be53bf92a5bad64ba0032282458b}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!solver\+Restart@{solver\+Restart}}
\index{solver\+Restart@{solver\+Restart}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{solver\+Restart}{solverRestart}}
{\footnotesize\ttfamily enum \hyperlink{class_a_m_r_level_mushy_layer_ae580be53bf92a5bad64ba0032282458b}{A\+M\+R\+Level\+Mushy\+Layer\+::solver\+Restart}\hspace{0.3cm}{\ttfamily [protected]}}



What to do when restarting after a failed timestep. 

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{m\+\_\+restart\+Halve\+Dt@{m\+\_\+restart\+Halve\+Dt}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!m\+\_\+restart\+Halve\+Dt@{m\+\_\+restart\+Halve\+Dt}}}\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ae580be53bf92a5bad64ba0032282458bae62a0ef77c0cf96f38983824de51f8d5}\label{class_a_m_r_level_mushy_layer_ae580be53bf92a5bad64ba0032282458bae62a0ef77c0cf96f38983824de51f8d5}} 
m\+\_\+restart\+Halve\+Dt&Restart and set dt = dt/2. \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{m\+\_\+restart\+Reset\+Data@{m\+\_\+restart\+Reset\+Data}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!m\+\_\+restart\+Reset\+Data@{m\+\_\+restart\+Reset\+Data}}}\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ae580be53bf92a5bad64ba0032282458ba0d29913c8280770cbd3501f7d3f0963a}\label{class_a_m_r_level_mushy_layer_ae580be53bf92a5bad64ba0032282458ba0d29913c8280770cbd3501f7d3f0963a}} 
m\+\_\+restart\+Reset\+Data&Restart and return solution to it\textquotesingle{}s state before this timestep. \\
\hline

\end{DoxyEnumFields}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_acae45525ac3755ce260e5e3db2090f82}\label{class_a_m_r_level_mushy_layer_acae45525ac3755ce260e5e3db2090f82}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!add\+Heat\+Source@{add\+Heat\+Source}}
\index{add\+Heat\+Source@{add\+Heat\+Source}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{add\+Heat\+Source()}{addHeatSource()}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::add\+Heat\+Source (\begin{DoxyParamCaption}\item[{\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&}]{src }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Add a fixed heat source. 

$ Q = \frac{Q_0}{\sigma \sqrt{2 \pi}} \exp\left[ - 0.5 \left( \frac{x-x_c}{\sigma} \right)^2 \right] 0.5 \left( 1 + \tanh\left[10 (z-(H-h)) \right]) \right) $

where the parameters are found from the inputs file as\+: Q\+\_\+0 is given by heat\+Source.\+size sigma is heat\+Source.\+width x\+\_\+c is heat\+Source.\+xpos h is heat\+Source.\+depth, and measures the depth that the heat source propagates down from the top of the domain

H is the domain height \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aa2aeb21dddb01b6406407104dd66c09b}\label{class_a_m_r_level_mushy_layer_aa2aeb21dddb01b6406407104dd66c09b}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!add\+Melt\+Pond@{add\+Melt\+Pond}}
\index{add\+Melt\+Pond@{add\+Melt\+Pond}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{add\+Melt\+Pond()}{addMeltPond()}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::add\+Melt\+Pond (\begin{DoxyParamCaption}\item[{int}]{depth,  }\item[{\textbf{ Real}}]{salinity,  }\item[{\textbf{ Real}}]{enthalpy,  }\item[{bool}]{rescale\+Existing\+Solution = {\ttfamily false} }\end{DoxyParamCaption})}



Add a melt pond at the top of the domain. 

We just do a very simple linear rescaling for now, so the old domain 0 $<$ z $<$ h becomes 0 $<$ z $<$ h-\/dh, and new variables are denoted by a {\ttfamily , i.\+e. we need a mapping for H(0 $<$ z $<$ h) -\/$>$ H}(0 $<$ z $<$ h-\/dh), and S-\/$>$S` We assume that the boundary conditions on the new domain are the same as the old domain at the new extent, i.\+e. H{\ttfamily (h-\/dh) = H(h), H}(h-\/dh) = S(h). then, H`(z) = H(z$\ast$(h-\/dh)/h) = H(z$\ast$(1-\/dh/h))

Stretching maps z-\/$>$z{\ttfamily , via z} = z$\ast$stretching\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ade318c50bdedb60ab371246da6895666}\label{class_a_m_r_level_mushy_layer_ade318c50bdedb60ab371246da6895666}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!advect\+Active\+Tracer@{advect\+Active\+Tracer}}
\index{advect\+Active\+Tracer@{advect\+Active\+Tracer}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{advect\+Active\+Tracer()}{advectActiveTracer()}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::advect\+Active\+Tracer (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Advect active tracer $ \zeta $. 

$ \frac{\partial \zeta}{\partial t} + \mathbf{U} \cdot \nabla (\zeta/\chi) = S(x,z)$ where $ S(x,z) $ is a source/sink of the tracer defined in \hyperlink{class_a_m_r_level_mushy_layer_a1175d9df4f5acbc4de503d9cb253947e}{compute\+Active\+Tracer\+Source\+Sink()} \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aff2c6df2ba8316ced0ae3aa476c676f4}\label{class_a_m_r_level_mushy_layer_aff2c6df2ba8316ced0ae3aa476c676f4}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!advect\+Passive\+Tracer@{advect\+Passive\+Tracer}}
\index{advect\+Passive\+Tracer@{advect\+Passive\+Tracer}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{advect\+Passive\+Tracer()}{advectPassiveTracer()}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::advect\+Passive\+Tracer (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Advect a passive tracer $ \xi $. 

$ \frac{\partial \xi}{\partial t} + \mathbf{U} \cdot \nabla (\xi/\chi) = S(x,z)$ \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a367dd316723860bb7bd1c8b97895a3f4}\label{class_a_m_r_level_mushy_layer_a367dd316723860bb7bd1c8b97895a3f4}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!advect\+Scalar@{advect\+Scalar}}
\index{advect\+Scalar@{advect\+Scalar}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{advect\+Scalar()}{advectScalar()}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::advect\+Scalar (\begin{DoxyParamCaption}\item[{const int}]{a\+\_\+scalar\+Var,  }\item[{const int}]{a\+\_\+advection\+Var,  }\item[{\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&}]{a\+\_\+adv\+Vel,  }\item[{bool}]{do\+F\+Rupdates = {\ttfamily true} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Update a scalar field by advection. 

a\+\_\+scalar\+Var is the field which is updated, whilst a\+\_\+advection\+Var is the field that has been advected. These don\textquotesingle{}t need to be the same, i.\+e. could do advect\+Scalar(enthalpy, temperature, ...) in order to compute an update for the equation d(enthalpy)/dt + u.\+grad(temperature) = 0 \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a57a9b87c77a7e0aa8b9082dc1a20959d}\label{class_a_m_r_level_mushy_layer_a57a9b87c77a7e0aa8b9082dc1a20959d}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!A\+M\+R\+Reflux\+Lambda@{A\+M\+R\+Reflux\+Lambda}}
\index{A\+M\+R\+Reflux\+Lambda@{A\+M\+R\+Reflux\+Lambda}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{A\+M\+R\+Reflux\+Lambda()}{AMRRefluxLambda()}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::\+A\+M\+R\+Reflux\+Lambda (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Reflux $ \lambda $ across \textbf{ A\+MR} hierarchy. 

Only call from base level \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a0169d83decd5824058e36a4b126f762a}\label{class_a_m_r_level_mushy_layer_a0169d83decd5824058e36a4b126f762a}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!calculate\+Time\+Ind\+Advection\+Vel@{calculate\+Time\+Ind\+Advection\+Vel}}
\index{calculate\+Time\+Ind\+Advection\+Vel@{calculate\+Time\+Ind\+Advection\+Vel}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{calculate\+Time\+Ind\+Advection\+Vel()}{calculateTimeIndAdvectionVel()}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::calculate\+Time\+Ind\+Advection\+Vel (\begin{DoxyParamCaption}\item[{\textbf{ Real}}]{time,  }\item[{\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&}]{a\+\_\+adv\+Vel }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Calculate advection velocity for momentum equations which are time independent. 

This source file contains methods relating to the velocity field \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a2fd9b54613cbc9b22453ecf6986f2cf0}\label{class_a_m_r_level_mushy_layer_a2fd9b54613cbc9b22453ecf6986f2cf0}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!compute\+C\+Cvelocity@{compute\+C\+Cvelocity}}
\index{compute\+C\+Cvelocity@{compute\+C\+Cvelocity}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{compute\+C\+Cvelocity()}{computeCCvelocity()}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::compute\+C\+Cvelocity (\begin{DoxyParamCaption}\item[{const \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&}]{advection\+Source\+Term,  }\item[{\textbf{ Real}}]{a\+\_\+old\+Time,  }\item[{\textbf{ Real}}]{a\+\_\+dt,  }\item[{bool}]{do\+F\+Rupdates = {\ttfamily false},  }\item[{bool}]{a\+\_\+do\+Projection = {\ttfamily true},  }\item[{bool}]{compute\+\_\+u\+DelU = {\ttfamily true},  }\item[{bool}]{a\+\_\+\+M\+A\+Cprojection = {\ttfamily false} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Compute new cell centred velocity. 

Generally done via an implicit update due to the viscous and darcy terms. Not required if just considering the Darcy equation. \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ab631de0d0116894c33286646a97eb395}\label{class_a_m_r_level_mushy_layer_ab631de0d0116894c33286646a97eb395}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!compute\+Mush\+Depth@{compute\+Mush\+Depth}}
\index{compute\+Mush\+Depth@{compute\+Mush\+Depth}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{compute\+Mush\+Depth()}{computeMushDepth()}}
{\footnotesize\ttfamily \textbf{ Real} A\+M\+R\+Level\+Mushy\+Layer\+::compute\+Mush\+Depth (\begin{DoxyParamCaption}\item[{\textbf{ Real}}]{a\+\_\+porosity\+\_\+criteria = {\ttfamily 0.99} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Compute mushy layer depth. 

Compute horizontally averaged porosity, then determine that the mushy layer starts at the minimum height where the porosity is $<$ a\+\_\+porosity\+\_\+criteria. \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a77914a8f6be67642c366b4da8e0a2829}\label{class_a_m_r_level_mushy_layer_a77914a8f6be67642c366b4da8e0a2829}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!compute\+Scalar\+Advective\+Flux@{compute\+Scalar\+Advective\+Flux}}
\index{compute\+Scalar\+Advective\+Flux@{compute\+Scalar\+Advective\+Flux}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{compute\+Scalar\+Advective\+Flux()}{computeScalarAdvectiveFlux()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::compute\+Scalar\+Advective\+Flux (\begin{DoxyParamCaption}\item[{\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&}]{a\+\_\+edge\+Scal,  }\item[{\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&}]{a\+\_\+old\+\_\+scal,  }\item[{\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&}]{a\+\_\+adv\+\_\+vel,  }\item[{\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&}]{a\+\_\+inflow\+Outflow\+Vel,  }\item[{\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&}]{a\+\_\+old\+\_\+vel,  }\item[{\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&}]{a\+\_\+diffusive\+Src,  }\item[{\textbf{ Patch\+Godunov} \&}]{a\+\_\+patch\+God,  }\item[{\textbf{ Real}}]{a\+\_\+old\+\_\+time,  }\item[{\textbf{ Real}}]{a\+\_\+dt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Compute the advective flux given the scalar field, advection velocity and source term specified. 

Should work for multiple components \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_af3fc0d2c619ba6ad099b1ad6c39b352e}\label{class_a_m_r_level_mushy_layer_af3fc0d2c619ba6ad099b1ad6c39b352e}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!compute\+Scalar\+Advective\+Flux@{compute\+Scalar\+Advective\+Flux}}
\index{compute\+Scalar\+Advective\+Flux@{compute\+Scalar\+Advective\+Flux}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{compute\+Scalar\+Advective\+Flux()}{computeScalarAdvectiveFlux()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::compute\+Scalar\+Advective\+Flux (\begin{DoxyParamCaption}\item[{\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&}]{a\+\_\+edge\+Scal,  }\item[{int}]{a\+\_\+advection\+Var,  }\item[{int}]{a\+\_\+diffusion\+Var,  }\item[{\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&}]{a\+\_\+adv\+Vel,  }\item[{\textbf{ Real}}]{a\+\_\+old\+\_\+time,  }\item[{\textbf{ Real}}]{a\+\_\+dt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Compute the advective flux. 

advection var is what we advect diffusion var determines the variable used to calculate the diffusive src. Set to -\/1 to use no source. \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a496393891a2db8a73b2f398f90324af5}\label{class_a_m_r_level_mushy_layer_a496393891a2db8a73b2f398f90324af5}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!compute\+Scalar\+Advective\+Flux\+Multi\+Comp@{compute\+Scalar\+Advective\+Flux\+Multi\+Comp}}
\index{compute\+Scalar\+Advective\+Flux\+Multi\+Comp@{compute\+Scalar\+Advective\+Flux\+Multi\+Comp}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{compute\+Scalar\+Advective\+Flux\+Multi\+Comp()}{computeScalarAdvectiveFluxMultiComp()}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::compute\+Scalar\+Advective\+Flux\+Multi\+Comp (\begin{DoxyParamCaption}\item[{\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&}]{a\+\_\+edge\+Scal,  }\item[{\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&}]{a\+\_\+adv\+Vel,  }\item[{\textbf{ Patch\+Godunov} \&}]{a\+\_\+patch\+God,  }\item[{\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&}]{a\+\_\+scal\+Old,  }\item[{\textbf{ Real}}]{a\+\_\+old\+\_\+time,  }\item[{\textbf{ Real}}]{a\+\_\+dt }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Compute the advective flux for the enthalpy and salinity equations,. 

Compute temperature and salinity advective flux.

edge\+Scal contains two components\+: $ (\mathbf{U} T, \mathbf{U} S_l) $ or $ (V H, V S) $ depending on the parameters given \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a0b8cde0fa8d437f3fc9a21461945af7e}\label{class_a_m_r_level_mushy_layer_a0b8cde0fa8d437f3fc9a21461945af7e}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!compute\+Scalar\+Conc\+In\+Liquid@{compute\+Scalar\+Conc\+In\+Liquid}}
\index{compute\+Scalar\+Conc\+In\+Liquid@{compute\+Scalar\+Conc\+In\+Liquid}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{compute\+Scalar\+Conc\+In\+Liquid()}{computeScalarConcInLiquid()}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::compute\+Scalar\+Conc\+In\+Liquid (\begin{DoxyParamCaption}\item[{\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&}]{liquid\+\_\+tracer\+\_\+conc,  }\item[{int}]{a\+\_\+tracer\+Var }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Compute concentration of scalar (with bulk concentration $ \xi $ ) in the liquid phase. 

$ \xi/\chi $ \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a414498736c19f68d326f85cd10e33512}\label{class_a_m_r_level_mushy_layer_a414498736c19f68d326f85cd10e33512}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!compute\+Scalar\+Diffusive\+Src@{compute\+Scalar\+Diffusive\+Src}}
\index{compute\+Scalar\+Diffusive\+Src@{compute\+Scalar\+Diffusive\+Src}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{compute\+Scalar\+Diffusive\+Src()}{computeScalarDiffusiveSrc()}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::compute\+Scalar\+Diffusive\+Src (\begin{DoxyParamCaption}\item[{int}]{a\+\_\+scalar\+Bulk\+Conc,  }\item[{\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&}]{a\+\_\+src }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Compute diffusive src for some scalar with bulk concentration $ \xi $. 

$ S = \nabla \cdot \chi \nabla (\xi/\chi)$ \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a8f04027bc844bd17a8bed1e073978436}\label{class_a_m_r_level_mushy_layer_a8f04027bc844bd17a8bed1e073978436}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!compute\+Total\+Advective\+Fluxes@{compute\+Total\+Advective\+Fluxes}}
\index{compute\+Total\+Advective\+Fluxes@{compute\+Total\+Advective\+Fluxes}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{compute\+Total\+Advective\+Fluxes()}{computeTotalAdvectiveFluxes()}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::compute\+Total\+Advective\+Fluxes (\begin{DoxyParamCaption}\item[{\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&}]{edge\+Scal\+Total }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Compute total fluxes that provide the source term for implicit enthalpy-\/salinity updates. 

$ (\mathbf{U} T + V H \mathbf{k}, \mathbf{U} S_l + V S \mathbf{k})$ \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ae4a68a07aa1a72f00379d30039bc8567}\label{class_a_m_r_level_mushy_layer_ae4a68a07aa1a72f00379d30039bc8567}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!compute\+Ustar@{compute\+Ustar}}
\index{compute\+Ustar@{compute\+Ustar}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{compute\+Ustar()}{computeUstar()}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::compute\+Ustar (\begin{DoxyParamCaption}\item[{\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&}]{a\+\_\+u\+Delu,  }\item[{const \textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&}]{advection\+Source\+Term,  }\item[{\textbf{ Real}}]{a\+\_\+old\+Time,  }\item[{\textbf{ Real}}]{a\+\_\+dt,  }\item[{bool}]{do\+F\+Rupdates,  }\item[{bool}]{a\+\_\+\+M\+A\+Cprojection = {\ttfamily false},  }\item[{bool}]{compute\+\_\+u\+DelU = {\ttfamily true} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Compute $ \mathbf{U}^* $, the velocity before we project it. 

In particular, we explicitly solve for the velocity $ \left[ 1 - \Delta t^\ell \, \left(Da \, \left(\nabla^\ell\right)^2 - \frac{\chi^{\ell, n+1}}{\Pi^{\ell, n+1}} \right) \right] \mathbf{U}^{\ell, n+1}_* = \mathbf{U}^{\ell, n} + \Delta t^\ell \left\{- \chi^{\ell, n+1/2} \, \nabla^\ell \pi^{\ell, n-1/2} + \chi^{\ell, n+1/2} \left[Pr \, Da^2 \left( Ra_T \theta^{\ell, n+1/2} - Ra_C \Theta^{\ell, n+1/2} \right) \right] - \mathbf{U}_{AD, CC}^{\ell, n+1/2} \cdot \nabla^\ell \left( \frac{\mathbf{U}}{\chi} \right)^{\ell, n+1/2} \right\}$ \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a24f8ccde175e9273958d5511b525cdbb}\label{class_a_m_r_level_mushy_layer_a24f8ccde175e9273958d5511b525cdbb}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!define@{define}}
\index{define@{define}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{define()}{define()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::define (\begin{DoxyParamCaption}\item[{\hyperlink{struct_mushy_layer_options}{Mushy\+Layer\+Options}}]{a\+\_\+opt,  }\item[{\hyperlink{class_mushy_layer_params}{Mushy\+Layer\+Params}}]{a\+\_\+params }\end{DoxyParamCaption})}



Defines this \hyperlink{class_a_m_r_level_mushy_layer}{A\+M\+R\+Level\+Mushy\+Layer}. 

Porosity for Darcy-\/\+Brinkman, permeability for Darcy \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a1ed163b80b24d3dc053097d24dc55be5}\label{class_a_m_r_level_mushy_layer_a1ed163b80b24d3dc053097d24dc55be5}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!define@{define}}
\index{define@{define}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{define()}{define()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::define (\begin{DoxyParamCaption}\item[{\textbf{ A\+M\+R\+Level} $\ast$}]{a\+\_\+coarser\+Level\+Ptr,  }\item[{const \textbf{ Problem\+Domain} \&}]{a\+\_\+problem\+Domain,  }\item[{int}]{a\+\_\+level,  }\item[{int}]{a\+\_\+ref\+Ratio }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Define new \hyperlink{class_a_m_r_level_mushy_layer}{A\+M\+R\+Level\+Mushy\+Layer} from coarser. 

Bio 

Reimplemented from \textbf{ A\+M\+R\+Level}.

\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a906ecc9974f8cfee4d6709e12c150a3e}\label{class_a_m_r_level_mushy_layer_a906ecc9974f8cfee4d6709e12c150a3e}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!do\+Regularisation\+Ops@{do\+Regularisation\+Ops}}
\index{do\+Regularisation\+Ops@{do\+Regularisation\+Ops}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{do\+Regularisation\+Ops()}{doRegularisationOps()}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::do\+Regularisation\+Ops (\begin{DoxyParamCaption}\item[{\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&}]{a\+\_\+scal,  }\item[{int}]{a\+\_\+var,  }\item[{int}]{a\+\_\+comp = {\ttfamily 0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Operations to keep variables bounded correctly. 

Porosity $ \chi > 0 $ Liquid concentration $ -1 <= \Theta_l <= 0 $ \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a75b13a9a6c8b2f6db2e1268e760ca9f9}\label{class_a_m_r_level_mushy_layer_a75b13a9a6c8b2f6db2e1268e760ca9f9}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!do\+Velocity\+Advection@{do\+Velocity\+Advection}}
\index{do\+Velocity\+Advection@{do\+Velocity\+Advection}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{do\+Velocity\+Advection()}{doVelocityAdvection()}}
{\footnotesize\ttfamily bool A\+M\+R\+Level\+Mushy\+Layer\+::do\+Velocity\+Advection (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Do we need to do velocity advection? 

I.\+e. do we solve for $ \mathbf{U} \cdot \nabla (\mathbf{U}/\chi) $ terms? \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a33522b27aabe2763e57c66c2ab4e2e09}\label{class_a_m_r_level_mushy_layer_a33522b27aabe2763e57c66c2ab4e2e09}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!fill\+Buoyancy@{fill\+Buoyancy}}
\index{fill\+Buoyancy@{fill\+Buoyancy}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{fill\+Buoyancy()}{fillBuoyancy()}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::fill\+Buoyancy (\begin{DoxyParamCaption}\item[{\textbf{ F\+Array\+Box} \&}]{buoyancy,  }\item[{\textbf{ F\+Array\+Box} \&}]{temperature,  }\item[{\textbf{ F\+Array\+Box} \&}]{liquid\+Conc,  }\item[{\textbf{ F\+Array\+Box} \&}]{porosity,  }\item[{\textbf{ F\+Array\+Box} \&}]{body\+Force }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Compute the buoyancy force. 

$ \mathbf{B} = \chi ( Ra_T \theta - Ra_C \Theta_l + \mathbf{F} \cdot \mathbf{k} ) \mathbf{k} $ \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a67558aa3b7d4e0e04f06c44b54f8ab1e}\label{class_a_m_r_level_mushy_layer_a67558aa3b7d4e0e04f06c44b54f8ab1e}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!fill\+Unprojected\+Darcy\+Velocity@{fill\+Unprojected\+Darcy\+Velocity}}
\index{fill\+Unprojected\+Darcy\+Velocity@{fill\+Unprojected\+Darcy\+Velocity}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{fill\+Unprojected\+Darcy\+Velocity()}{fillUnprojectedDarcyVelocity()}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::fill\+Unprojected\+Darcy\+Velocity (\begin{DoxyParamCaption}\item[{\textbf{ Level\+Data}$<$ \textbf{ Flux\+Box} $>$ \&}]{a\+\_\+adv\+Vel,  }\item[{\textbf{ Real}}]{time }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Fill unprojected darcy velocity. 

$ \mathbf{U}^* = (\Pi/\nu) * (Ra_T \theta - Ra_C \Theta_l + \mathbf{F}_B) $

where $ \mathbf{F}_B $ is a body force (=0 by default) \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a0e1a5d490de9799a0579aa3bcc35a021}\label{class_a_m_r_level_mushy_layer_a0e1a5d490de9799a0579aa3bcc35a021}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!get\+Coarse\+Scalar\+Data\+Pointers@{get\+Coarse\+Scalar\+Data\+Pointers}}
\index{get\+Coarse\+Scalar\+Data\+Pointers@{get\+Coarse\+Scalar\+Data\+Pointers}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{get\+Coarse\+Scalar\+Data\+Pointers()}{getCoarseScalarDataPointers()}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::get\+Coarse\+Scalar\+Data\+Pointers (\begin{DoxyParamCaption}\item[{const int}]{a\+\_\+scalar\+Var,  }\item[{\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ $\ast$$\ast$}]{a\+\_\+coarser\+Data\+Old\+Ptr,  }\item[{\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ $\ast$$\ast$}]{a\+\_\+coarser\+Data\+New\+Ptr,  }\item[{\textbf{ Level\+Flux\+Register} $\ast$$\ast$}]{a\+\_\+coarser\+F\+R\+Ptr,  }\item[{\textbf{ Level\+Flux\+Register} $\ast$$\ast$}]{a\+\_\+finer\+F\+R\+Ptr,  }\item[{\textbf{ Real} \&}]{a\+\_\+t\+Coarser\+Old,  }\item[{\textbf{ Real} \&}]{a\+\_\+t\+Coarser\+New }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Smooth the velocity field. 

Utility function to get pointers to coarse level objects \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_afbb2adb1dd99e2b69bcb58d5395fe3b5}\label{class_a_m_r_level_mushy_layer_afbb2adb1dd99e2b69bcb58d5395fe3b5}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!grids@{grids}}
\index{grids@{grids}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{grids()}{grids()}}
{\footnotesize\ttfamily \textbf{ Disjoint\+Box\+Layout} A\+M\+R\+Level\+Mushy\+Layer\+::grids (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Whether or not to compute diagnostics. 

Get the grids on this level \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_abc11317ec5dd18433dc83b3ab2aaf959}\label{class_a_m_r_level_mushy_layer_abc11317ec5dd18433dc83b3ab2aaf959}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!init\+Time\+Independent\+Pressure@{init\+Time\+Independent\+Pressure}}
\index{init\+Time\+Independent\+Pressure@{init\+Time\+Independent\+Pressure}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{init\+Time\+Independent\+Pressure()}{initTimeIndependentPressure()}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::init\+Time\+Independent\+Pressure (\begin{DoxyParamCaption}\item[{\hyperlink{class_a_m_r_level_mushy_layer}{A\+M\+R\+Level\+Mushy\+Layer} $\ast$}]{lev,  }\item[{int}]{a\+\_\+max\+\_\+num\+\_\+iter = {\ttfamily -\/1} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Initialise phi (pressure for Darcy equation) 

By default a\+\_\+max\+\_\+num\+\_\+iter = -\/1, meaning we use the globally defined value in m\+\_\+opt.\+num\+\_\+init\+\_\+passes \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a28479bc8ab69c855a8d79628cddd5b28}\label{class_a_m_r_level_mushy_layer_a28479bc8ab69c855a8d79628cddd5b28}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!reset\+Lambda@{reset\+Lambda}}
\index{reset\+Lambda@{reset\+Lambda}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{reset\+Lambda()}{resetLambda()}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::reset\+Lambda (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}



Flag if a new level has been added. 

Reset $ \lambda = 1$ \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a8032590f0d7a8160dc1a56151648f7c8}\label{class_a_m_r_level_mushy_layer_a8032590f0d7a8160dc1a56151648f7c8}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!reshape\+Data@{reshape\+Data}}
\index{reshape\+Data@{reshape\+Data}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{reshape\+Data()}{reshapeData()}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::reshape\+Data (\begin{DoxyParamCaption}\item[{\textbf{ Disjoint\+Box\+Layout}}]{new\+Grids,  }\item[{\textbf{ Problem\+Domain}}]{new\+Domain }\end{DoxyParamCaption})}



Transfer data to new disjoint box layout. 

Changed to allow changes in either x or y directions. \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_ad9766575f35a8fc27568ad7dde975eec}\label{class_a_m_r_level_mushy_layer_ad9766575f35a8fc27568ad7dde975eec}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!set\+Defaults@{set\+Defaults}}
\index{set\+Defaults@{set\+Defaults}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{set\+Defaults()}{setDefaults()}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::set\+Defaults (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Set default values. 

This source file contains methods for initialising and defining objects \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a5064704173348a8efa158f400983a101}\label{class_a_m_r_level_mushy_layer_a5064704173348a8efa158f400983a101}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!set\+Eta@{set\+Eta}}
\index{set\+Eta@{set\+Eta}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{set\+Eta()}{setEta()}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::set\+Eta (\begin{DoxyParamCaption}\item[{\textbf{ Real}}]{a\+\_\+eta }\end{DoxyParamCaption})}



Set eta on all projection operators. 

Only call from level 0 \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aea3d5cfb654cc0e1e0f14bea830add39}\label{class_a_m_r_level_mushy_layer_aea3d5cfb654cc0e1e0f14bea830add39}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!smooth\+Scalar\+Field@{smooth\+Scalar\+Field}}
\index{smooth\+Scalar\+Field@{smooth\+Scalar\+Field}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{smooth\+Scalar\+Field()}{smoothScalarField()}}
{\footnotesize\ttfamily void A\+M\+R\+Level\+Mushy\+Layer\+::smooth\+Scalar\+Field (\begin{DoxyParamCaption}\item[{\textbf{ Level\+Data}$<$ \textbf{ F\+Array\+Box} $>$ \&}]{a\+\_\+phi,  }\item[{int}]{a\+\_\+var,  }\item[{\textbf{ Real}}]{a\+\_\+smoothing }\end{DoxyParamCaption})}



Smooth some scalar field. 

smoothing done implicitly via an elliptic solve. Obtains smooth field $\phi_{smooth}$ by solving $ (1-\alpha \nabla^2)\phi_{smooth} = \phi $ where $\alpha$ is the smoothing parameter a\+\_\+smoothing 

\subsection{Member Data Documentation}
\mbox{\Hypertarget{class_a_m_r_level_mushy_layer_af41eb6058681e1345ce40633dd9fde1f}\label{class_a_m_r_level_mushy_layer_af41eb6058681e1345ce40633dd9fde1f}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!m\+\_\+adv\+\_\+vel\+\_\+centering@{m\+\_\+adv\+\_\+vel\+\_\+centering}}
\index{m\+\_\+adv\+\_\+vel\+\_\+centering@{m\+\_\+adv\+\_\+vel\+\_\+centering}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{m\+\_\+adv\+\_\+vel\+\_\+centering}{m\_adv\_vel\_centering}}
{\footnotesize\ttfamily \textbf{ Real} A\+M\+R\+Level\+Mushy\+Layer\+::m\+\_\+adv\+\_\+vel\+\_\+centering\hspace{0.3cm}{\ttfamily [protected]}}



If this level has only just been added due to regridding. 

The advection velocity is calculated at old\+\_\+time + m\+\_\+adv\+\_\+vel\+\_\+centering$\ast$dt Usually 0.\+5, but set to something smaller after regridding for stability \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_aa7a6e8a5cb2cb6f690c047e46d70547f}\label{class_a_m_r_level_mushy_layer_aa7a6e8a5cb2cb6f690c047e46d70547f}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!m\+\_\+computed\+C\+FL@{m\+\_\+computed\+C\+FL}}
\index{m\+\_\+computed\+C\+FL@{m\+\_\+computed\+C\+FL}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{m\+\_\+computed\+C\+FL}{m\_computedCFL}}
{\footnotesize\ttfamily \textbf{ Real} A\+M\+R\+Level\+Mushy\+Layer\+::m\+\_\+computed\+C\+FL\hspace{0.3cm}{\ttfamily [protected]}}



The C\+FL number we\textquotesingle{}re currently running at. 

computed from the current max velocity and the grid spacing. \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a731a16b4dfaecb9235357b88e251af97}\label{class_a_m_r_level_mushy_layer_a731a16b4dfaecb9235357b88e251af97}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!m\+\_\+enforce\+GradP@{m\+\_\+enforce\+GradP}}
\index{m\+\_\+enforce\+GradP@{m\+\_\+enforce\+GradP}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{m\+\_\+enforce\+GradP}{m\_enforceGradP}}
{\footnotesize\ttfamily bool A\+M\+R\+Level\+Mushy\+Layer\+::m\+\_\+enforce\+GradP\hspace{0.3cm}{\ttfamily [protected]}}



Should we enforce some analytic $ \nabla P $. 

Usually false, but can be useful to do this for benchmark problems \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a49000dfb8d30dc44b35fc1c802c9fd4c}\label{class_a_m_r_level_mushy_layer_a49000dfb8d30dc44b35fc1c802c9fd4c}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!m\+\_\+max\+Lambda@{m\+\_\+max\+Lambda}}
\index{m\+\_\+max\+Lambda@{m\+\_\+max\+Lambda}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{m\+\_\+max\+Lambda}{m\_maxLambda}}
{\footnotesize\ttfamily \textbf{ Real} A\+M\+R\+Level\+Mushy\+Layer\+::m\+\_\+max\+Lambda\hspace{0.3cm}{\ttfamily [protected]}}



Store max value of $ \lambda-1 $ from previous timestep. 

We may decide to increase $ \eta $ if we\textquotesingle{}re not decreasing lambda quickly enough \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a5ac61ca83db82c5642e21d7cbe83f37b}\label{class_a_m_r_level_mushy_layer_a5ac61ca83db82c5642e21d7cbe83f37b}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!m\+\_\+num\+Ghost\+Advection@{m\+\_\+num\+Ghost\+Advection}}
\index{m\+\_\+num\+Ghost\+Advection@{m\+\_\+num\+Ghost\+Advection}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{m\+\_\+num\+Ghost\+Advection}{m\_numGhostAdvection}}
{\footnotesize\ttfamily int A\+M\+R\+Level\+Mushy\+Layer\+::m\+\_\+num\+Ghost\+Advection\hspace{0.3cm}{\ttfamily [protected]}}



Number of ghost cells for advection calculations. 

Generally need extra ghost cells when doing advection problems \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a3652e6785ac8c5e429a5ac286ea3bc2e}\label{class_a_m_r_level_mushy_layer_a3652e6785ac8c5e429a5ac286ea3bc2e}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!m\+\_\+opt@{m\+\_\+opt}}
\index{m\+\_\+opt@{m\+\_\+opt}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{m\+\_\+opt}{m\_opt}}
{\footnotesize\ttfamily \hyperlink{struct_mushy_layer_options}{Mushy\+Layer\+Options} A\+M\+R\+Level\+Mushy\+Layer\+::m\+\_\+opt\hspace{0.3cm}{\ttfamily [protected]}}



Struct to contain all the options for this simulation. 

This is so we can easily pass all the options around, and don\textquotesingle{}t have to keep going into parmparse \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_a53408b847afbe94238f1f19daf166f2f}\label{class_a_m_r_level_mushy_layer_a53408b847afbe94238f1f19daf166f2f}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!m\+\_\+pressure\+Scale\+Var@{m\+\_\+pressure\+Scale\+Var}}
\index{m\+\_\+pressure\+Scale\+Var@{m\+\_\+pressure\+Scale\+Var}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{m\+\_\+pressure\+Scale\+Var}{m\_pressureScaleVar}}
{\footnotesize\ttfamily int A\+M\+R\+Level\+Mushy\+Layer\+::m\+\_\+pressure\+Scale\+Var\hspace{0.3cm}{\ttfamily [protected]}}



Which field scales the pressure. 

We either have $ \chi \nabla P $ or $ \Pi \nabla P $ \mbox{\Hypertarget{class_a_m_r_level_mushy_layer_af6dd293bd80f201846fc7d6fe6f851b1}\label{class_a_m_r_level_mushy_layer_af6dd293bd80f201846fc7d6fe6f851b1}} 
\index{A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}!m\+\_\+use\+Prev\+Pressure\+For\+U\+Star@{m\+\_\+use\+Prev\+Pressure\+For\+U\+Star}}
\index{m\+\_\+use\+Prev\+Pressure\+For\+U\+Star@{m\+\_\+use\+Prev\+Pressure\+For\+U\+Star}!A\+M\+R\+Level\+Mushy\+Layer@{A\+M\+R\+Level\+Mushy\+Layer}}
\subsubsection{\texorpdfstring{m\+\_\+use\+Prev\+Pressure\+For\+U\+Star}{m\_usePrevPressureForUStar}}
{\footnotesize\ttfamily bool A\+M\+R\+Level\+Mushy\+Layer\+::m\+\_\+use\+Prev\+Pressure\+For\+U\+Star\hspace{0.3cm}{\ttfamily [protected]}}



Should we use previous $ \nabla P $ to calculate $ \mathbf{u}^* $. 

We then subtract off $ \nabla P $ before actually doing the projection 

The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/parkinsonjl/mushy-\/layer/src\+Subcycle/A\+M\+R\+Level\+Mushy\+Layer.\+H\item 
/home/parkinsonjl/mushy-\/layer/src\+Subcycle/A\+M\+R\+Level\+Mushy\+Layer.\+cpp\item 
/home/parkinsonjl/mushy-\/layer/src\+Subcycle/A\+M\+R\+Level\+Mushy\+Layer\+Biogeochemistry.\+cpp\item 
/home/parkinsonjl/mushy-\/layer/src\+Subcycle/A\+M\+R\+Level\+Mushy\+Layer\+Diagnostics.\+cpp\item 
/home/parkinsonjl/mushy-\/layer/src\+Subcycle/A\+M\+R\+Level\+Mushy\+Layer\+Fill.\+cpp\item 
/home/parkinsonjl/mushy-\/layer/src\+Subcycle/A\+M\+R\+Level\+Mushy\+Layer\+Init.\+cpp\item 
/home/parkinsonjl/mushy-\/layer/src\+Subcycle/A\+M\+R\+Level\+Mushy\+Layer\+I\+O.\+cpp\item 
/home/parkinsonjl/mushy-\/layer/src\+Subcycle/A\+M\+R\+Level\+Mushy\+Layer\+Regrid.\+cpp\item 
/home/parkinsonjl/mushy-\/layer/src\+Subcycle/A\+M\+R\+Level\+Mushy\+Layer\+Sync.\+cpp\item 
/home/parkinsonjl/mushy-\/layer/src\+Subcycle/A\+M\+R\+Level\+Mushy\+Layer\+Vel.\+cpp\end{DoxyCompactItemize}
